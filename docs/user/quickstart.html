

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quickstart &mdash; qdk-chemistry 1.0.0-rc1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=a64bac2b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=81bd8d55"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/tabs.js?v=3ee01567"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="In-depth user guide" href="comprehensive/index.html" />
    <link rel="prev" title="QDK/Chemistry: A Quantum Applications Toolkit" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            qdk-chemistry
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#end-to-end-example">End-to-end example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-structure-object">Create a <code class="docutils literal notranslate"><span class="pre">Structure</span></code> object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-a-self-consistent-field-scf-calculation">Run a self-consistent field (SCF) calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#select-an-active-space">Select an active space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculate-the-hamiltonian">Calculate the Hamiltonian</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compute-a-multi-configuration-wavefunction-for-the-active-space">Compute a multi-configuration wavefunction for the active space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#select-important-configurations">Select important configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preparing-a-qubit-representation-of-the-hamiltonian">Preparing a qubit representation of the Hamiltonian</a></li>
<li class="toctree-l3"><a class="reference internal" href="#estimate-the-ground-state-energy-using-a-quantum-algorithm">Estimate the ground state energy using a quantum algorithm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#additional-examples">Additional examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="comprehensive/index.html">In-depth user guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/cpp_api.html">C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Acronym definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">qdk-chemistry</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quickstart</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user/quickstart.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quickstart">
<h1>Quickstart<a class="headerlink" href="#quickstart" title="Link to this heading"></a></h1>
<p>These quickstart instructions provide a high-level overview of the typical workflow when using the QDK/Chemistry library.
More comprehensive documentation can be found in the <a class="reference internal" href="comprehensive/index.html"><span class="doc">In-depth user guide</span></a>.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>To install QDK/Chemistry, please see the <a class="reference external" href="https://github.com/microsoft/qdk-chemistry/blob/main/INSTALL.md">installation instructions</a>.</p>
</section>
<section id="end-to-end-example">
<h2>End-to-end example<a class="headerlink" href="#end-to-end-example" title="Link to this heading"></a></h2>
<p>This document is intended to provide a brief introduction to the QDK/Chemistry library by walking through a minimal end-to-end example for ground state energy estimation with state preparation and measurement.
The emphasis of this example is optimization:  reducing the resources required for the quantum computer.
The example starts with a molecular structure and ends with a simulated calculation using quantum algorithms.
The focus of this example is on high-level concepts and common coding patterns.</p>
<p>You can also view a related code sample in a Jupyter notebook format, along with several other examples, in the <a class="reference external" href="https://github.com/microsoft/qdk-chemistry/blob/main/examples/">examples folder</a> of the GitHub repository.</p>
<section id="create-a-structure-object">
<h3>Create a <code class="docutils literal notranslate"><span class="pre">Structure</span></code> object<a class="headerlink" href="#create-a-structure-object" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Structure</span></code> class represents a molecular structure, i.e. the coordinates of its atoms.
<code class="docutils literal notranslate"><span class="pre">Structure</span></code> objects can be constructed manually, or via deserialization from a file.
QDK/Chemistry supports multiple serialization formats for <code class="docutils literal notranslate"><span class="pre">Structure</span></code> objects, including the standard <a class="reference external" href="https://en.wikipedia.org/wiki/XYZ_file_format">XYZ file format</a>, as well as QDK/Chemistry-specific JSON and HDF5 serialization schemes.
Internally to QDK/Chemistry, coordinates are always stored in Bohr/atomic units; however, when reading or writing to files, the units follow the file format convention (XYZ) or can be specified (JSON, HDF5).
See below for language specific examples of creating and serializing <code class="docutils literal notranslate"><span class="pre">Structure</span></code> objects.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Define benzene diradical structure directly using coordinates</span>
<span class="w">  </span><span class="n">Eigen</span><span class="o">::</span><span class="n">MatrixXd</span><span class="w"> </span><span class="nf">coords</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">  </span><span class="n">coords</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">1.396000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">1.209077</span><span class="p">,</span><span class="w"> </span><span class="mf">0.698000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span>
<span class="w">      </span><span class="mf">1.209077</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.698000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.396000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.209077</span><span class="p">,</span>
<span class="w">      </span><span class="mf">-0.698000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.209077</span><span class="p">,</span><span class="w"> </span><span class="mf">0.698000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">2.151000</span><span class="p">,</span><span class="w"> </span><span class="mf">1.242000</span><span class="p">,</span>
<span class="w">      </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">2.151000</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.242000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.151000</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.242000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">,</span>
<span class="w">      </span><span class="mf">-2.151000</span><span class="p">,</span><span class="w"> </span><span class="mf">1.242000</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000000</span><span class="p">;</span>

<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">,</span>
<span class="w">                                       </span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;H&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;H&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;H&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;H&quot;</span><span class="p">};</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">structure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">data</span><span class="o">::</span><span class="n">Structure</span><span class="o">&gt;</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="w"> </span><span class="n">elements</span><span class="p">);</span>

<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Created structure with &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">structure</span><span class="o">-&gt;</span><span class="n">get_num_atoms</span><span class="p">()</span>
<span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; atoms&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Elements: &quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">structure</span><span class="o">-&gt;</span><span class="n">get_elements</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">data</span><span class="o">::</span><span class="n">Structure</span><span class="o">::</span><span class="n">element_to_symbol</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">create</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Structure</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.data.qubit_hamiltonian</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">filter_and_group_pauli_ops_from_wavefunction</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.utils.wavefunction</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_top_determinants</span>

<span class="c1"># Define benzene diradical structure directly using numpy arrays</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.000000</span><span class="p">,</span> <span class="mf">1.396000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.209077</span><span class="p">,</span> <span class="mf">0.698000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.209077</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.698000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.000000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.396000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">1.209077</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.698000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">1.209077</span><span class="p">,</span> <span class="mf">0.698000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">2.151000</span><span class="p">,</span> <span class="mf">1.242000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">2.151000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.242000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">2.151000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.242000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">2.151000</span><span class="p">,</span> <span class="mf">1.242000</span><span class="p">,</span> <span class="mf">0.000000</span><span class="p">],</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]</span>
<span class="n">structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">elements</span><span class="p">)</span>

<span class="c1"># Alternative: load from XYZ file</span>
<span class="c1"># from pathlib import Path</span>
<span class="c1"># structure = Structure.from_xyz_file(Path(&quot;benzene_diradical.structure.xyz&quot;))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created structure with </span><span class="si">{</span><span class="n">structure</span><span class="o">.</span><span class="n">get_num_atoms</span><span class="p">()</span><span class="si">}</span><span class="s2"> atoms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elements: </span><span class="si">{</span><span class="n">structure</span><span class="o">.</span><span class="n">get_elements</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-a-self-consistent-field-scf-calculation">
<h3>Run a self-consistent field (SCF) calculation<a class="headerlink" href="#run-a-self-consistent-field-scf-calculation" title="Link to this heading"></a></h3>
<p>Once a <code class="docutils literal notranslate"><span class="pre">Structure</span></code> is created, an <a class="reference internal" href="../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> calculation can be performed to produce an initial <code class="docutils literal notranslate"><span class="pre">Wavefunction</span></code> as well as an <a class="reference internal" href="../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> energy.
QDK/Chemistry performs <a class="reference internal" href="../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> calculations via instantiations of the <code class="docutils literal notranslate"><span class="pre">ScfSolver</span></code> algorithm.
Instantiations of the <code class="docutils literal notranslate"><span class="pre">ScfSolver</span></code> algorithm (and all other <code class="docutils literal notranslate"><span class="pre">Algorithm</span></code> classes for that matter) are managed by a factory.
See the <span class="xref std std-doc">comprehensive/advanced/factory_pattern</span> documentation for more information on how it is used in the QDK/Chemistry.</p>
<p>The inputs for an <a class="reference internal" href="../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> calculation are a <code class="docutils literal notranslate"><span class="pre">Structure</span></code> object, the charge and multiplicity of the molecular system, and information about the single-particle basis to be used.
Optionally, <code class="docutils literal notranslate"><span class="pre">Settings</span></code> specific to the particular <code class="docutils literal notranslate"><span class="pre">ScfSolver</span></code> can be configured by accessing the <code class="docutils literal notranslate"><span class="pre">settings()</span></code> method.
The basis for the <a class="reference internal" href="../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> calculation can be set via a string input, a custom basis set or initial orbitals can also be provided.
See below for language-specific examples.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Perform an SCF calculation</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">scf_solver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">algorithms</span><span class="o">::</span><span class="n">ScfSolverFactory</span><span class="o">::</span><span class="n">create</span><span class="p">();</span>
<span class="w">  </span><span class="n">scf_solver</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;basis_set&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cc-pvdz&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">E_hf</span><span class="p">,</span><span class="w"> </span><span class="n">wfn_hf</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scf_solver</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;SCF energy is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">E_hf</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; Hartree&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Display a summary of the molecular orbitals</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;SCF Orbitals:</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">wfn_hf</span><span class="o">-&gt;</span><span class="n">get_orbitals</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">get_summary</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perform an SCF calculation, returning the energy and wavefunction</span>
<span class="n">scf_solver</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;scf_solver&quot;</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;cc-pvdz&quot;</span><span class="p">)</span>
<span class="n">E_hf</span><span class="p">,</span> <span class="n">wfn_hf</span> <span class="o">=</span> <span class="n">scf_solver</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin_multiplicity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SCF energy is </span><span class="si">{</span><span class="n">E_hf</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> Hartree&quot;</span><span class="p">)</span>

<span class="c1"># Display a summary of the molecular orbitals obtained from the SCF calculation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SCF Orbitals:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">wfn_hf</span><span class="o">.</span><span class="n">get_orbitals</span><span class="p">()</span><span class="o">.</span><span class="n">get_summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-an-active-space">
<h3>Select an active space<a class="headerlink" href="#select-an-active-space" title="Link to this heading"></a></h3>
<p>While a full set of <a class="reference internal" href="../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> orbitals are useful for many applications, they are often not the optimal set for further post-<a class="reference internal" href="../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> calculations.
For this reason, both localization (orbital manipulation) and active space selection (orbital selection) algorithms are provided within QDK/Chemistry.</p>
<p>QDK/Chemistry offers many methods for the selection of active spaces to reduce the problem size:  accurately modeling the quantum many-body problem while avoiding the prohibitive computational scaling of full configuration interaction.
See the <a class="reference internal" href="comprehensive/algorithms/active_space.html"><span class="doc">Active space selection</span></a> documentation for a list of supported methods, along with their associated <code class="docutils literal notranslate"><span class="pre">Settings</span></code>, which accompany the standard QDK/Chemistry distribution.</p>
<p>The following are language-specific examples of how to select a so-called “valence” active space containing a subset of only those orbitals surrounding the Fermi level.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Select active space (6 electrons in 6 orbitals)</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_space_selector</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">algorithms</span><span class="o">::</span><span class="n">ActiveSpaceSelectorFactory</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;qdk_valence&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">active_space_selector</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;num_active_electrons&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="w">  </span><span class="n">active_space_selector</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;num_active_orbitals&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_wfn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">active_space_selector</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">wfn_hf</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_orbitals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">active_wfn</span><span class="o">-&gt;</span><span class="n">get_orbitals</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Print a summary of the active space orbitals</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Active Space Orbitals:</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">active_orbitals</span><span class="o">-&gt;</span><span class="n">get_summary</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Python API</label><div class="tab-content docutils container">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example shows the API pattern. For complete working examples, see <a class="reference internal" href="comprehensive/algorithms/active_space.html"><span class="doc">Active space selection</span></a>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select active space (6 electrons in 6 orbitals for the benzene diradical)</span>
<span class="c1">#   to choose most chemically relevant orbitals</span>
<span class="n">active_space_selector</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span>
    <span class="s2">&quot;active_space_selector&quot;</span><span class="p">,</span>
    <span class="n">algorithm_name</span><span class="o">=</span><span class="s2">&quot;qdk_valence&quot;</span><span class="p">,</span>
    <span class="n">num_active_electrons</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">num_active_orbitals</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">active_wfn</span> <span class="o">=</span> <span class="n">active_space_selector</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">wfn_hf</span><span class="p">)</span>
<span class="n">active_orbitals</span> <span class="o">=</span> <span class="n">active_wfn</span><span class="o">.</span><span class="n">get_orbitals</span><span class="p">()</span>

<span class="c1"># Print a summary of the active space orbitals</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Active Space Orbitals:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">active_orbitals</span><span class="o">.</span><span class="n">get_summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-the-hamiltonian">
<h3>Calculate the Hamiltonian<a class="headerlink" href="#calculate-the-hamiltonian" title="Link to this heading"></a></h3>
<p>Once an active space has been selected, the electronic Hamiltonian can be computed within that active space to describe the energetic interactions between electrons.
QDK/Chemistry provides flexible Hamiltonian construction capabilities through the <code class="docutils literal notranslate"><span class="pre">HamiltonianConstructor</span></code> algorithm.
The Hamiltonian constructor can generate the one- and two-electron integrals needed for subsequent quantum many-body calculations.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Construct Hamiltonian in the active space</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">hamiltonian_constructor</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">algorithms</span><span class="o">::</span><span class="n">HamiltonianConstructorFactory</span><span class="o">::</span><span class="n">create</span><span class="p">();</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamiltonian_constructor</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">active_orbitals</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Active Space Hamiltonian:</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">hamiltonian</span><span class="o">-&gt;</span><span class="n">get_summary</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Python API</label><div class="tab-content docutils container">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example shows the API pattern. For complete working examples, see <a class="reference internal" href="comprehensive/algorithms/hamiltonian_constructor.html"><span class="doc">Classical Hamiltonian construction</span></a>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct Hamiltonian in the active space and print its summary</span>
<span class="n">hamiltonian_constructor</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;hamiltonian_constructor&quot;</span><span class="p">)</span>
<span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">hamiltonian_constructor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">active_orbitals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Active Space Hamiltonian:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="o">.</span><span class="n">get_summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-a-multi-configuration-wavefunction-for-the-active-space">
<h3>Compute a multi-configuration wavefunction for the active space<a class="headerlink" href="#compute-a-multi-configuration-wavefunction-for-the-active-space" title="Link to this heading"></a></h3>
<p>With the active space Hamiltonian constructed, quantum many-body calculations
can be performed to obtain accurate electronic energies and wavefunctions.
QDK/Chemistry supports various Multi-Configuration (MC) methods including full
Configuration Interaction (CI) and selected <a class="reference internal" href="../glossary.html#term-CI"><span class="xref std std-term">CI</span></a> approaches.
<a class="reference internal" href="../glossary.html#term-MC"><span class="xref std std-term">MC</span></a> calculations are performed via instantiations of the <code class="docutils literal notranslate"><span class="pre">MultiConfigurationCalculator</span></code> algorithm.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Perform CASCI calculation</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">mc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">algorithms</span><span class="o">::</span><span class="n">MultiConfigurationCalculatorFactory</span><span class="o">::</span><span class="n">create</span><span class="p">();</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">E_cas</span><span class="p">,</span><span class="w"> </span><span class="n">wfn_cas</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mc</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;CASCI energy is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">E_cas</span>
<span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; Hartree, and the electron correlation energy is &quot;</span>
<span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">E_cas</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_hf</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; Hartree&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Python API</label><div class="tab-content docutils container">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example shows the API pattern. For complete working examples, see <a class="reference internal" href="comprehensive/algorithms/mc_calculator.html"><span class="doc">Multi-configuration calculations</span></a>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perform CASCI calculation to get the wavefunction and exact energy for the active space</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;multi_configuration_calculator&quot;</span><span class="p">)</span>
<span class="n">E_cas</span><span class="p">,</span> <span class="n">wfn_cas</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">n_active_alpha_electrons</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_active_beta_electrons</span><span class="o">=</span><span class="mi">3</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;CASCI energy is </span><span class="si">{</span><span class="n">E_cas</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> Hartree, and the electron correlation energy is </span><span class="si">{</span><span class="n">E_cas</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_hf</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> Hartree&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-important-configurations">
<h3>Select important configurations<a class="headerlink" href="#select-important-configurations" title="Link to this heading"></a></h3>
<p>For large active spaces, the multi-configuration <span class="xref std std-doc">Wavefunction</span> may contain thousands or millions of configurations, but often only a small subset contributes significantly to the overall state.
By identifying and retaining only the dominant configurations (those with the largest amplitudes), we can create a sparse wavefunction that maintains high fidelity with the original while dramatically reducing computational requirements for quantum state preparation.
This truncation is characterized by computing the overlap between the truncated state and the full wavefunction, and by recalculating the energy of the reduced wavefunction using the <code class="docutils literal notranslate"><span class="pre">ProjectedMultiConfigurationCalculator</span></code>.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @brief Get top N determinants from a wavefunction sorted by coefficient</span>
<span class="cm"> * magnitude</span>
<span class="cm"> * @param wfn The wavefunction to extract determinants from</span>
<span class="cm"> * @param max_determinants Maximum number of determinants to return</span>
<span class="cm"> * @return Vector of top configurations</span>
<span class="cm"> */</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">data</span><span class="o">::</span><span class="n">Configuration</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_top_determinants</span><span class="p">(</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">data</span><span class="o">::</span><span class="n">Wavefunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">wfn</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">max_determinants</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">determinants</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wfn</span><span class="o">-&gt;</span><span class="n">get_active_determinants</span><span class="p">();</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">coeffs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wfn</span><span class="o">-&gt;</span><span class="n">get_coefficients</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Extract coefficients as doubles (handle real case)</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">coeff_values</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">real_coeffs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">get</span><span class="o">&lt;</span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="o">&gt;</span><span class="p">(</span><span class="n">coeffs</span><span class="p">);</span>
<span class="w">  </span><span class="n">coeff_values</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">real_coeffs</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">real_coeffs</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">coeff_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">real_coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Create indices and sort by coefficient magnitude</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">indices</span><span class="p">(</span><span class="n">determinants</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">iota</span><span class="p">(</span><span class="n">indices</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">indices</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span><span class="n">indices</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">indices</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="n">coeff_values</span><span class="p">](</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">coeff_values</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">coeff_values</span><span class="p">[</span><span class="n">i2</span><span class="p">];</span>
<span class="w">            </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// Extract top determinants</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">data</span><span class="o">::</span><span class="n">Configuration</span><span class="o">&gt;</span><span class="w"> </span><span class="n">top_dets</span><span class="p">;</span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">min</span><span class="p">(</span><span class="n">max_determinants</span><span class="p">,</span><span class="w"> </span><span class="n">determinants</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="w">  </span><span class="n">top_dets</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">top_dets</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">determinants</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">top_dets</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get top 2 determinants from the CASCI wavefunction to form a sparse wavefunction</span>
<span class="n">top_configurations</span> <span class="o">=</span> <span class="n">get_top_determinants</span><span class="p">(</span><span class="n">wfn_cas</span><span class="p">,</span> <span class="n">max_determinants</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Compute the reference energy of the sparse wavefunction</span>
<span class="n">pmc_calculator</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;projected_multi_configuration_calculator&quot;</span><span class="p">)</span>
<span class="n">E_sparse</span><span class="p">,</span> <span class="n">wfn_sparse</span> <span class="o">=</span> <span class="n">pmc_calculator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">top_configurations</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reference energy for top 2 determinants is </span><span class="si">{</span><span class="n">E_sparse</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> Hartree&quot;</span><span class="p">)</span>

<span class="c1"># Generate state preparation circuit for the sparse state via sparse isometry (GF2 + X)</span>
<span class="n">state_prep</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;state_prep&quot;</span><span class="p">,</span> <span class="s2">&quot;sparse_isometry_gf2x&quot;</span><span class="p">)</span>
<span class="n">sparse_isometry_circuit</span> <span class="o">=</span> <span class="n">state_prep</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">wfn_sparse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="preparing-a-qubit-representation-of-the-hamiltonian">
<h3>Preparing a qubit representation of the Hamiltonian<a class="headerlink" href="#preparing-a-qubit-representation-of-the-hamiltonian" title="Link to this heading"></a></h3>
<p>To execute quantum algorithms on actual quantum hardware, the Fermionic <a class="reference internal" href="comprehensive/data/hamiltonian.html"><span class="doc">Hamiltonian</span></a> must be mapped to a qubit Hamiltonian composed of Pauli operators.
QDK/Chemistry supports multiple encoding schemes including the Jordan-Wigner and Bravyi-Kitaev transformations.
The resulting qubit Hamiltonian is represented as a sum of Pauli strings (tensor products of Pauli <span class="math notranslate nohighlight">\(X, Y, Z\)</span>, and identity operators), each with an associated coefficient.</p>
<p>For efficient energy estimation, the qubit Hamiltonian can be optimized in two ways.
First, by filtering out terms that have negligible expectation values given the sparse <span class="xref std std-doc">wavefunction</span>, pre-computing their classical contributions.
Second, by grouping the remaining Pauli operators into commuting sets that can be measured simultaneously, significantly reducing the number of measurement circuits required on the quantum device.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// This step only available in Python API currently.</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepare qubit Hamiltonian</span>
<span class="n">qubit_mapper</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;qubit_mapper&quot;</span><span class="p">,</span> <span class="n">algorithm_name</span><span class="o">=</span><span class="s2">&quot;qiskit&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;jordan-wigner&quot;</span><span class="p">)</span>
<span class="n">qubit_hamiltonian</span> <span class="o">=</span> <span class="n">qubit_mapper</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">)</span>

<span class="c1"># Print the number of Pauli strings in the full Hamiltonian</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Number of Pauli strings in the Hamiltonian: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">qubit_hamiltonian</span><span class="o">.</span><span class="n">pauli_strings</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>

<span class="c1"># Filter and group Pauli operators based on the wavefunction</span>
<span class="n">filtered_hamiltonian_ops</span><span class="p">,</span> <span class="n">classical_coeffs</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">filter_and_group_pauli_ops_from_wavefunction</span><span class="p">(</span><span class="n">qubit_hamiltonian</span><span class="p">,</span> <span class="n">wfn_sparse</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Filtered and grouped qubit Hamiltonian contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_hamiltonian_ops</span><span class="p">)</span><span class="si">}</span><span class="s2"> groups:&quot;</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">igroup</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filtered_hamiltonian_ops</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group </span><span class="si">{</span><span class="n">igroup</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="p">[</span><span class="n">group</span><span class="o">.</span><span class="n">pauli_strings</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of classical coefficients: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">classical_coeffs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="estimate-the-ground-state-energy-using-a-quantum-algorithm">
<h3>Estimate the ground state energy using a quantum algorithm<a class="headerlink" href="#estimate-the-ground-state-energy-using-a-quantum-algorithm" title="Link to this heading"></a></h3>
<p>The final step combines the state preparation circuit with the measurement circuits derived from the grouped qubit <a class="reference internal" href="comprehensive/data/hamiltonian.html"><span class="doc">Hamiltonian</span></a> to estimate the ground state energy.
Each measurement circuit appends specific Pauli basis rotations to the state preparation circuit, followed by computational basis measurements.
The measurement outcomes are repeated many times (shots) to build up statistics for each observable group.</p>
<p>The energy expectation value is computed by combining the measurement statistics from each group with their corresponding Hamiltonian coefficients and the pre-computed classical contributions.
The statistical nature of quantum measurements introduces variance in the energy estimate, which decreases as the number of shots is increased.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// This step only available in Python API currently.</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate energy using the optimized circuit and filtered Hamiltonian operators</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;energy_estimator&quot;</span><span class="p">,</span> <span class="n">algorithm_name</span><span class="o">=</span><span class="s2">&quot;qdk_base_simulator&quot;</span><span class="p">)</span>
<span class="n">energy_results</span><span class="p">,</span> <span class="n">simulation_data</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">circuit_qasm</span><span class="o">=</span><span class="n">sparse_isometry_circuit</span><span class="p">,</span>
    <span class="n">qubit_hamiltonians</span><span class="o">=</span><span class="n">filtered_hamiltonian_ops</span><span class="p">,</span>
    <span class="n">total_shots</span><span class="o">=</span><span class="mi">250000</span><span class="p">,</span>
    <span class="n">classical_coeffs</span><span class="o">=</span><span class="n">classical_coeffs</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">results</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">simulation_data</span><span class="o">.</span><span class="n">bitstring_counts</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Measurement Results for Hamiltonian Group </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">simulation_data</span><span class="o">.</span><span class="n">hamiltonians</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pauli_strings</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

<span class="c1"># Print statistic for measured energy</span>
<span class="n">energy_mean</span> <span class="o">=</span> <span class="n">energy_results</span><span class="o">.</span><span class="n">energy_expectation_value</span> <span class="o">+</span> <span class="n">hamiltonian</span><span class="o">.</span><span class="n">get_core_energy</span><span class="p">()</span>
<span class="n">energy_stddev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">energy_results</span><span class="o">.</span><span class="n">energy_variance</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Estimated energy from quantum circuit: </span><span class="si">{</span><span class="n">energy_mean</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">energy_stddev</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> Hartree&quot;</span>
<span class="p">)</span>

<span class="c1"># Print comparison with reference energy</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference from reference energy: </span><span class="si">{</span><span class="n">energy_mean</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_sparse</span><span class="si">}</span><span class="s2"> Hartree&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="additional-examples">
<h2>Additional examples<a class="headerlink" href="#additional-examples" title="Link to this heading"></a></h2>
<p>Additional examples of workflows using QDK/Chemistry can be found in the <code class="docutils literal notranslate"><span class="pre">examples</span></code> directory of the source repository.
See the <a class="reference internal" href="comprehensive/index.html"><span class="doc">In-depth user guide</span></a> for links to more detailed documentation on specific components of QDK/Chemistry.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="QDK/Chemistry: A Quantum Applications Toolkit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="comprehensive/index.html" class="btn btn-neutral float-right" title="In-depth user guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Microsoft Corporation. All rights reserved. Licensed under the MIT License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>