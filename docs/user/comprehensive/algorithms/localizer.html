

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Orbital localization &mdash; qdk-chemistry 1.0.0-rc1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=a64bac2b" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=81bd8d55"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/tabs.js?v=3ee01567"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Multi-configuration calculations" href="mc_calculator.html" />
    <link rel="prev" title="Hamiltonian construction" href="hamiltonian_constructor.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            qdk-chemistry
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Features, methods and dependencies</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">In-depth user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../design/index.html">High-level design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">Data classes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Algorithm classes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="factory_pattern.html">Factory pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="settings.html">Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="active_space.html">Active space selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="energy_estimator.html">Energy estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="hamiltonian_constructor.html">Hamiltonian construction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Orbital localization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-orbital-localization">Running orbital localization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#available-implementations">Available implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#related-classes">Related classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#further-reading">Further reading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mc_calculator.html">Multi-configuration calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="mcscf.html">Multi-configuration <span class="xref std std-term">SCF</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="qubit_mapper.html">Qubit mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="scf_solver.html">Self-consistent field (SCF) solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="stability_checker.html">Stability analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="state_preparation.html">State preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#quick-reference">Quick reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#discovering-implementations">Discovering implementations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basis_functionals.html">Available functionals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model_hamiltonians.html">Model Hamiltonians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins.html">Plugins</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/cpp_api.html">C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Acronym definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">qdk-chemistry</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">In-depth user guide</a></li>
          <li class="breadcrumb-item"><a href="index.html">Algorithm classes</a></li>
      <li class="breadcrumb-item active">Orbital localization</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/user/comprehensive/algorithms/localizer.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="orbital-localization">
<h1>Orbital localization<a class="headerlink" href="#orbital-localization" title="Link to this heading"></a></h1>
<p>The <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.OrbitalLocalizer" title="qdk_chemistry.algorithms.OrbitalLocalizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrbitalLocalizer</span></code></a> algorithm in QDK/Chemistry performs various orbital transformations to create localized or otherwise transformed molecular orbitals.
Following QDK/Chemistry’s <a class="reference internal" href="../design/index.html"><span class="doc">algorithm design principles</span></a>, it takes a <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.Wavefunction" title="qdk_chemistry.data.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a> instance with reference orbitals as input and produces a new <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.Wavefunction" title="qdk_chemistry.data.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a> instance with localized orbitals as output.
For more information about this pattern, see the <a class="reference internal" href="factory_pattern.html"><span class="doc">Factory Pattern</span></a> documentation.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Canonical molecular orbitals from <a class="reference internal" href="../../../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> calculations are typically delocalized over the entire molecule, which can complicate chemical interpretation and slow the convergence of post-<a class="reference internal" href="../../../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> correlation methods.
The <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.OrbitalLocalizer" title="qdk_chemistry.algorithms.OrbitalLocalizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrbitalLocalizer</span></code></a> algorithm applies unitary transformations to these orbitals to obtain alternative representations that may be more physically intuitive or computationally advantageous.</p>
<p>Orbital transformation techniques broadly fall into two categories:</p>
<dl class="simple">
<dt><strong>Optimization-Based Methods</strong></dt><dd><p>The vast majority of localization methods define a cost function and iteratively minimize it to yield localized orbitals <span id="id1">[<a class="reference internal" href="../../../references.html#id38" title="Susi Lehtola and Hannes Jónsson. Unitary optimization of localized molecular orbitals. Journal of Chemical Theory and Computation, 9(12):5365-5372, 2013. URL: https://doi.org/10.1021/ct400793q, doi:10.1021/ct400793q.">LJ13</a>]</span>.
Popular choices include <strong>Pipek-Mezey</strong> <span id="id2">[<a class="reference internal" href="../../../references.html#id35" title="János Pipek and Paul G. Mezey. A fast intrinsic localization procedure applicable for ab initio and semiempirical linear combination of atomic orbital wave functions. The Journal of Chemical Physics, 90(9):4916-4926, 05 1989. URL: https://doi.org/10.1063/1.456588, doi:10.1063/1.456588.">PM89</a>]</span>, <strong>Foster-Boys</strong> <span id="id3">[<a class="reference internal" href="../../../references.html#id37" title="J. M. Foster and S. F. Boys. Canonical configurational interaction procedure. Rev. Mod. Phys., 32:300–302, Apr 1960. URL: https://link.aps.org/doi/10.1103/RevModPhys.32.300, doi:10.1103/RevModPhys.32.300.">FB60</a>]</span>, and <strong>Edmiston-Ruedenberg</strong> <span id="id4">[<a class="reference internal" href="../../../references.html#id36" title="Clyde Edmiston and Klaus Ruedenberg. Localized atomic and molecular orbitals. Rev. Mod. Phys., 35:457–464, Jul 1963. URL: https://link.aps.org/doi/10.1103/RevModPhys.35.457, doi:10.1103/RevModPhys.35.457.">ER63</a>]</span> localization.
These methods produce orbitals that are maximally localized on specific atoms or bonds.</p>
</dd>
<dt><strong>Analytical Methods</strong></dt><dd><p>These methods transform orbitals in a single step through analytical techniques rather than iterative optimization.
<strong>Natural orbitals</strong> <span id="id5">[<a class="reference internal" href="../../../references.html#id34" title="Per-Olov Löwdin and Harrison Shull. Natural orbitals in the quantum theory of two-electron systems. Physical Review, 101:1730–1739, Mar 1956. URL: https://link.aps.org/doi/10.1103/PhysRev.101.1730, doi:10.1103/PhysRev.101.1730.">LowdinS56</a>]</span>, which diagonalize the one-particle reduced density matrix, are a prominent example and can be particularly useful for <a class="reference internal" href="active_space.html"><span class="doc">active space selection</span></a>.
<strong>Cholesky localization</strong> <span id="id6">[<a class="reference internal" href="../../../references.html#id50" title="Francesco Aquilante, Thomas Bondo Pedersen, Alfredo Sánchez de Merás, and Henrik Koch. Fast noniterative orbital localization for large molecules. The Journal of Chemical Physics, 125(17):174101, 11 2006. URL: https://doi.org/10.1063/1.2360264, doi:10.1063/1.2360264.">ABPSdMK06</a>]</span> provides efficient approximate localization via Cholesky decomposition of the density matrix.
The <a class="reference internal" href="#vvhv-algorithm"><span class="std std-ref">VVHV separation</span></a> also falls into this category, using projection and orthogonalization to partition virtual orbitals into valence and hard-virtual subspaces.</p>
</dd>
</dl>
<p>The specific methods available depend on the backend implementation selected.
QDK/Chemistry provides native implementations of key algorithms and extends these capabilities through <a class="reference internal" href="../plugins.html"><span class="doc">plugins</span></a> that integrate external quantum chemistry packages.
See <a class="reference internal" href="#available-implementations">Available implementations</a> below for details on each backend and its supported methods.</p>
</section>
<section id="running-orbital-localization">
<h2>Running orbital localization<a class="headerlink" href="#running-orbital-localization" title="Link to this heading"></a></h2>
<p>This section demonstrates how to create, configure, and run orbital localization.
The <code class="docutils literal notranslate"><span class="pre">run</span></code> method takes a <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.Wavefunction" title="qdk_chemistry.data.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a> instance and returns a new <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.Wavefunction" title="qdk_chemistry.data.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a> object with transformed orbitals.</p>
<section id="input-requirements">
<h3>Input requirements<a class="headerlink" href="#input-requirements" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.OrbitalLocalizer" title="qdk_chemistry.algorithms.OrbitalLocalizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrbitalLocalizer</span></code></a> requires the following inputs:</p>
<dl class="simple">
<dt><strong>Wavefunction</strong></dt><dd><p>A <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.Wavefunction" title="qdk_chemistry.data.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a> instance containing the molecular orbitals to be localized.</p>
</dd>
<dt><strong>Alpha orbital indices (loc_indices_a)</strong></dt><dd><p>A list/vector of indices specifying which alpha orbitals to include in the localization. Indices must be sorted in ascending order.</p>
</dd>
<dt><strong>Beta orbital indices (loc_indices_b)</strong></dt><dd><p>A list/vector of indices specifying which beta orbitals to include in the localization. Indices must be sorted in ascending order.</p>
</dd>
</dl>
<p><strong>Creating a localizer:</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;qdk/chemistry.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">qdk</span><span class="o">::</span><span class="nn">chemistry</span><span class="o">::</span><span class="nn">algorithms</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">qdk</span><span class="o">::</span><span class="nn">chemistry</span><span class="o">::</span><span class="nn">data</span><span class="p">;</span>

<span class="c1">// Create a Pipek-Mezey localizer using the factory</span>
<span class="k">auto</span><span class="w"> </span><span class="n">localizer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalizerFactory</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;qdk_pipek_mezey&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">create</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Structure</span>

<span class="c1"># Create a Pipek-Mezey localizer</span>
<span class="n">localizer</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;orbital_localizer&quot;</span><span class="p">,</span> <span class="s2">&quot;qdk_pipek_mezey&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Configuring settings:</strong></p>
<p>Settings can be modified using the <code class="docutils literal notranslate"><span class="pre">settings()</span></code> object.
See <a class="reference internal" href="#available-implementations">Available implementations</a> below for implementation-specific options.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Configure settings for localizer</span>
<span class="w">  </span><span class="n">localizer</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;tolerance&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0e-6</span><span class="p">);</span>
<span class="w">  </span><span class="n">localizer</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;max_iterations&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">localizer</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">keys</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure localizer settings</span>
<span class="n">localizer</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;tolerance&quot;</span><span class="p">,</span> <span class="mf">1.0e-6</span><span class="p">)</span>
<span class="n">localizer</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;max_iterations&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># View available settings</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Localizer settings: </span><span class="si">{</span><span class="n">localizer</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Running localization:</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For restricted calculations, <code class="docutils literal notranslate"><span class="pre">loc_indices_a</span></code> and <code class="docutils literal notranslate"><span class="pre">loc_indices_b</span></code> must be identical.</p>
</div>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Create H2O molecule</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span><span class="o">&gt;</span><span class="w"> </span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">},</span>
<span class="w">                                         </span><span class="p">{</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.43052268</span><span class="p">,</span><span class="w"> </span><span class="mf">1.10926924</span><span class="p">},</span>
<span class="w">                                         </span><span class="p">{</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.43052268</span><span class="p">,</span><span class="w"> </span><span class="mf">1.10926924</span><span class="p">}};</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">symbols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;O&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;H&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;H&quot;</span><span class="p">};</span>
<span class="w">  </span><span class="n">Structure</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="w"> </span><span class="n">symbols</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Obtain orbitals from SCF calculation</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">scf_solver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ScfSolverFactory</span><span class="o">::</span><span class="n">create</span><span class="p">();</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">E_scf</span><span class="p">,</span><span class="w"> </span><span class="n">wavefunction</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scf_solver</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sto-3g&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Specify which orbitals to localize</span>
<span class="w">  </span><span class="c1">// For restricted calculations, alpha and beta orbitals are identical</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">loc_indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Localize the specified orbitals</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">localized_wfn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">localizer</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">wavefunction</span><span class="p">,</span><span class="w"> </span><span class="n">loc_indices</span><span class="p">,</span><span class="w"> </span><span class="n">loc_indices</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">localized_orbitals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">localized_wfn</span><span class="o">-&gt;</span><span class="n">get_orbitals</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Print summary</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">localizer</span><span class="o">-&gt;</span><span class="n">get_summary</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create H2O molecule</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.43052268</span><span class="p">,</span> <span class="mf">1.10926924</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.43052268</span><span class="p">,</span> <span class="mf">1.10926924</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]</span>
<span class="n">structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">)</span>

<span class="c1"># Obtain orbitals from SCF</span>
<span class="n">scf_solver</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;scf_solver&quot;</span><span class="p">)</span>
<span class="n">E_scf</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">scf_solver</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">structure</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin_multiplicity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">basis_or_guess</span><span class="o">=</span><span class="s2">&quot;sto-3g&quot;</span>
<span class="p">)</span>

<span class="c1"># Create indices for orbitals to localize</span>
<span class="n">loc_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># Localize the specified orbitals</span>
<span class="n">localized_wfn</span> <span class="o">=</span> <span class="n">localizer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">wfn</span><span class="p">,</span> <span class="n">loc_indices</span><span class="p">,</span> <span class="n">loc_indices</span><span class="p">)</span>

<span class="n">localized_orbitals</span> <span class="o">=</span> <span class="n">localized_wfn</span><span class="o">.</span><span class="n">get_orbitals</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">localized_orbitals</span><span class="o">.</span><span class="n">get_summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="available-implementations">
<h2>Available implementations<a class="headerlink" href="#available-implementations" title="Link to this heading"></a></h2>
<p>QDK/Chemistry’s <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.OrbitalLocalizer" title="qdk_chemistry.algorithms.OrbitalLocalizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrbitalLocalizer</span></code></a> provides a unified interface to orbital localization methods.
You can discover available implementations programmatically:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalizerFactory</span><span class="o">::</span><span class="n">available</span><span class="p">();</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">names</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">registry</span>  <span class="c1"># noqa: E402</span>

<span class="nb">print</span><span class="p">(</span><span class="n">registry</span><span class="o">.</span><span class="n">available</span><span class="p">(</span><span class="s2">&quot;orbital_localizer&quot;</span><span class="p">))</span>
<span class="c1"># [&#39;pyscf_multi&#39;, &#39;qdk_vvhv&#39;, &#39;qdk_mp2_natural_orbitals&#39;, &#39;qdk_pipek_mezey&#39;]</span>
</pre></div>
</div>
</div>
</div>
<section id="qdk-pipek-mezey">
<span id="localizer-qdk-pipek-mezey"></span><h3>QDK Pipek-Mezey<a class="headerlink" href="#qdk-pipek-mezey" title="Link to this heading"></a></h3>
<p><strong>Factory name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;qdk_pipek_mezey&quot;</span></code> (default)</p>
<p>Native implementation of Pipek-Mezey localization <span id="id7">[<a class="reference internal" href="../../../references.html#id35" title="János Pipek and Paul G. Mezey. A fast intrinsic localization procedure applicable for ab initio and semiempirical linear combination of atomic orbital wave functions. The Journal of Chemical Physics, 90(9):4916-4926, 05 1989. URL: https://doi.org/10.1063/1.456588, doi:10.1063/1.456588.">PM89</a>]</span>, which maximizes the sum of squared Mulliken charges on each atom for each orbital.
This produces orbitals that are maximally localized on specific atoms or bonds, making them well-suited for chemical interpretation and local correlation methods.</p>
<p><strong>Settings:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 15.0%" />
<col style="width: 15.0%" />
<col style="width: 45.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code></p></td>
<td><p>float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1e-6</span></code></p></td>
<td><p>Convergence criterion for localization iterations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">max_iterations</span></code></p></td>
<td><p>int</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10000</span></code></p></td>
<td><p>Maximum number of localization iterations</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">small_rotation_tolerance</span></code></p></td>
<td><p>float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1e-12</span></code></p></td>
<td><p>Threshold for small rotation detection</p></td>
</tr>
</tbody>
</table>
</section>
<section id="qdk-mp2-natural-orbitals">
<h3>QDK MP2 Natural Orbitals<a class="headerlink" href="#qdk-mp2-natural-orbitals" title="Link to this heading"></a></h3>
<p><strong>Factory name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;qdk_mp2_natural_orbitals&quot;</span></code></p>
<p>Computes natural orbitals <span id="id8">[<a class="reference internal" href="../../../references.html#id34" title="Per-Olov Löwdin and Harrison Shull. Natural orbitals in the quantum theory of two-electron systems. Physical Review, 101:1730–1739, Mar 1956. URL: https://link.aps.org/doi/10.1103/PhysRev.101.1730, doi:10.1103/PhysRev.101.1730.">LowdinS56</a>]</span> from the <a class="reference internal" href="../../../glossary.html#term-MP2"><span class="xref std std-term">MP2</span></a> one-particle density matrix.
These orbitals diagonalize the correlation effects and provide occupation numbers that can guide <a class="reference internal" href="active_space.html"><span class="doc">active space selection</span></a>.</p>
<p><strong>Settings:</strong> This implementation has no configurable settings.</p>
</section>
<section id="qdk-vvhv">
<span id="localizer-qdk-vvhv"></span><h3>QDK VVHV<a class="headerlink" href="#qdk-vvhv" title="Link to this heading"></a></h3>
<p><strong>Factory name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;qdk_vvhv&quot;</span></code></p>
<p>The <a class="reference internal" href="../../../glossary.html#term-VVHV"><span class="xref std std-term">VVHV</span></a> (Valence Virtual–Hard Virtual) localizer addresses the numerical challenges of orbital localization in near-complete basis sets by partitioning the virtual space into chemically meaningful subspaces.
See <a class="reference internal" href="#vvhv-algorithm"><span class="std std-ref">VVHV Algorithm</span></a> below for a detailed description.</p>
<p><strong>Settings:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 15.0%" />
<col style="width: 15.0%" />
<col style="width: 45.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code></p></td>
<td><p>float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1e-6</span></code></p></td>
<td><p>Convergence criterion for iterative localization optimization</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">max_iterations</span></code></p></td>
<td><p>int</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10000</span></code></p></td>
<td><p>Maximum number of localization iterations</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">small_rotation_tolerance</span></code></p></td>
<td><p>float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1e-12</span></code></p></td>
<td><p>Threshold for small rotation detection</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">minimal_basis</span></code></p></td>
<td><p>string</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;sto-3g&quot;</span></code></p></td>
<td><p>Minimal basis set for valence virtual projection</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">weighted_orthogonalization</span></code></p></td>
<td><p>bool</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Use weighted orthogonalization in hard virtual construction</p></td>
</tr>
</tbody>
</table>
<section id="vvhv-algorithm">
<span id="id9"></span><h4>VVHV Algorithm<a class="headerlink" href="#vvhv-algorithm" title="Link to this heading"></a></h4>
<p>Localization of molecular orbitals expressed in near-complete <a class="reference internal" href="../data/basis_set.html"><span class="doc">basis sets</span></a> is numerically ill-posed and challenging for most localizers.
This can lead to orbitals that do not vary smoothly with molecular geometry, numerically unstable results, and reproducibility difficulties across architectures and compute environments.
The Valence Virtual–Hard Virtual (<a class="reference internal" href="../../../glossary.html#term-VVHV"><span class="xref std std-term">VVHV</span></a>) separation <span id="id10">[<a class="reference internal" href="../../../references.html#id39" title="Joseph E. Subotnik, Anthony D. Dutoi, and Martin Head-Gordon. Fast localized orthonormal virtual orbitals which depend smoothly on nuclear coordinates. The Journal of Chemical Physics, 123(11):114108, 09 2005. URL: https://doi.org/10.1063/1.2033687, doi:10.1063/1.2033687.">SDHG05</a>]</span> addresses these problems by partitioning the virtual orbital space into chemically meaningful subspaces before localization.</p>
<p><strong>The Problem with Standard Localization</strong></p>
<p>Standard orbital localization methods optimize a cost function (e.g., Pipek-Mezey, Foster-Boys) over blocks of orbitals simultaneously (e.g. occupied, virtual, active).
In large basis sets, the virtual space contains orbitals of vastly different character:</p>
<ul class="simple">
<li><p><strong>Valence-virtual orbitals</strong>: Low-lying virtual orbitals that are chemically relevant for describing bond breaking/formation and correlation effects</p></li>
<li><p><strong>Hard-virtual orbitals</strong>: High-energy orbitals that primarily describe core-valence polarization and basis set completeness</p></li>
</ul>
<p>When localization is applied to the full virtual space, the optimizer may mix these distinct orbital types, leading to non-physical results that are sensitive to numerical precision and can vary discontinuously along reaction coordinates.</p>
<p><strong>The VVHV Separation Procedure</strong></p>
<p>The <a class="reference internal" href="../../../glossary.html#term-VVHV"><span class="xref std std-term">VVHV</span></a> algorithm proceeds in three stages:</p>
<ol class="arabic">
<li><p><strong>Minimal Basis Projection</strong>: Project the canonical virtual orbitals onto a minimal basis set (e.g., <a class="reference internal" href="../../../glossary.html#term-STO"><span class="xref std std-term">STO</span></a>-3G) to identify the valence-virtual subspace.
Given the overlap matrix <span class="math notranslate nohighlight">\(\mathbf{S}_{\text{min}}\)</span> between the computational basis and minimal basis, the valence-virtual orbitals span the range of:</p>
<div class="math notranslate nohighlight">
\[\mathbf{P}_{\text{VV}} = \mathbf{S}_{\text{min}} (\mathbf{S}_{\text{min}}^T \mathbf{S}_{\text{min}})^{-1} \mathbf{S}_{\text{min}}^T\]</div>
</li>
<li><p><strong>Orthogonalization</strong>: Construct orthonormal valence-virtual and hard-virtual orbital sets.
The hard-virtual orbitals are obtained as the orthogonal complement to the valence-virtual space.
QDK/Chemistry implements both standard and weighted orthogonalization <span id="id11">[<a class="reference internal" href="../../../references.html#id40" title="Zhenling Wang, Kevin Ikeda, Hengyuan Shen, Matthias Loipersberger, Alexander Zech, Abdulrahman Aldossary, Teresa Head-Gordon, and Martin Head-Gordon. Second-generation energy decomposition analysis of intermolecular interaction energies from the second-order mo̷ller–plesset theory: an extensible, orthogonal formulation with useful basis set convergence for all terms. Journal of Chemical Theory and Computation, 21(3):1163-1178, 2025. URL: https://doi.org/10.1021/acs.jctc.4c01301, doi:10.1021/acs.jctc.4c01301.">WIS+25</a>]</span> procedures; weighted orthogonalization improves numerical stability for near-linear dependencies.</p></li>
<li><p><strong>Subspace Localization</strong>: Apply the chosen localization method (e.g., Pipek-Mezey) separately within each subspace.
This ensures that the optimization landscape is well-behaved and that orbitals vary smoothly with geometry.</p></li>
</ol>
<p><strong>Benefits for Active Space Selection</strong></p>
<p>The <a class="reference internal" href="../../../glossary.html#term-VVHV"><span class="xref std std-term">VVHV</span></a> separation is particularly valuable for multi-configuration calculations where a consistent active space must be maintained along a reaction pathway.
By localizing only the valence-virtual orbitals, which are the chemically relevant virtual orbitals for active space construction, the <a class="reference internal" href="../../../glossary.html#term-VVHV"><span class="xref std std-term">VVHV</span></a> procedure ensures:</p>
<ul class="simple">
<li><p>Orbitals that track smoothly as bonds stretch and form</p></li>
<li><p>Numerically stable and reproducable results</p></li>
<li><p>Well-defined orbital character that aids chemical interpretation</p></li>
</ul>
<p>For details on using localized orbitals in active space selection, see <a class="reference internal" href="active_space.html"><span class="doc">ActiveSpaceSelector</span></a>.</p>
</section>
</section>
<section id="pyscf-multi">
<span id="localizer-pyscf-multi"></span><h3>PySCF Multi<a class="headerlink" href="#pyscf-multi" title="Link to this heading"></a></h3>
<p><strong>Factory name:</strong> <code class="docutils literal notranslate"><span class="pre">&quot;pyscf_multi&quot;</span></code></p>
<p>The PySCF <a class="reference internal" href="../plugins.html"><span class="doc">plugin</span></a> provides access to additional localization algorithms through <a class="reference external" href="https://pyscf.org/">PySCF</a>:</p>
<ul class="simple">
<li><p><strong>Pipek-Mezey</strong> <span id="id12">[<a class="reference internal" href="../../../references.html#id35" title="János Pipek and Paul G. Mezey. A fast intrinsic localization procedure applicable for ab initio and semiempirical linear combination of atomic orbital wave functions. The Journal of Chemical Physics, 90(9):4916-4926, 05 1989. URL: https://doi.org/10.1063/1.456588, doi:10.1063/1.456588.">PM89</a>]</span> — Maximizes atomic charge localization</p></li>
<li><p><strong>Foster-Boys</strong> <span id="id13">[<a class="reference internal" href="../../../references.html#id37" title="J. M. Foster and S. F. Boys. Canonical configurational interaction procedure. Rev. Mod. Phys., 32:300–302, Apr 1960. URL: https://link.aps.org/doi/10.1103/RevModPhys.32.300, doi:10.1103/RevModPhys.32.300.">FB60</a>]</span> — Minimizes the spatial extent of orbitals</p></li>
<li><p><strong>Edmiston-Ruedenberg</strong> <span id="id14">[<a class="reference internal" href="../../../references.html#id36" title="Clyde Edmiston and Klaus Ruedenberg. Localized atomic and molecular orbitals. Rev. Mod. Phys., 35:457–464, Jul 1963. URL: https://link.aps.org/doi/10.1103/RevModPhys.35.457, doi:10.1103/RevModPhys.35.457.">ER63</a>]</span> — Maximizes self-repulsion energy</p></li>
<li><p><strong>Cholesky</strong> <span id="id15">[<a class="reference internal" href="../../../references.html#id50" title="Francesco Aquilante, Thomas Bondo Pedersen, Alfredo Sánchez de Merás, and Henrik Koch. Fast noniterative orbital localization for large molecules. The Journal of Chemical Physics, 125(17):174101, 11 2006. URL: https://doi.org/10.1063/1.2360264, doi:10.1063/1.2360264.">ABPSdMK06</a>]</span> — Efficient analytical localization via Cholesky decomposition</p></li>
</ul>
<p><strong>Settings:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 15.0%" />
<col style="width: 15.0%" />
<col style="width: 45.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">method</span></code></p></td>
<td><p>string</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;pipek-mezey&quot;</span></code></p></td>
<td><p>Localization algorithm: <code class="docutils literal notranslate"><span class="pre">&quot;pipek-mezey&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;foster-boys&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;edmiston-ruedenberg&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;cholesky&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">population_method</span></code></p></td>
<td><p>string</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;mulliken&quot;</span></code></p></td>
<td><p>Population analysis method for Pipek-Mezey localization</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">occupation_threshold</span></code></p></td>
<td><p>float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1e-10</span></code></p></td>
<td><p>Threshold for classifying orbitals as occupied vs virtual</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="related-classes">
<h2>Related classes<a class="headerlink" href="#related-classes" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.Wavefunction" title="qdk_chemistry.data.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a>: Input and output container for orbitals and electronic state information</p></li>
<li><p><a class="reference internal" href="../data/orbitals.html"><span class="doc">Orbitals</span></a>: Molecular orbital data accessible via the wavefunction</p></li>
</ul>
</section>
<section id="further-reading">
<h2>Further reading<a class="headerlink" href="#further-reading" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>The above examples can be downloaded as complete <a class="reference external" href="../../../_static/examples/python/localizer.py">Python</a> or <a class="reference external" href="../../../_static/examples/cpp/localizer.cpp">C++</a> code.</p></li>
<li><p><a class="reference internal" href="scf_solver.html"><span class="doc">ScfSolver</span></a>: Produces initial orbitals for localization</p></li>
<li><p><a class="reference internal" href="active_space.html"><span class="doc">ActiveSpaceSelector</span></a>: Often used with localized orbitals for better active space selection</p></li>
<li><p><a class="reference internal" href="hamiltonian_constructor.html"><span class="doc">HamiltonianConstructor</span></a>: Can build Hamiltonians using localized orbitals</p></li>
<li><p><a class="reference internal" href="../data/serialization.html"><span class="doc">Serialization</span></a>: Data serialization and deserialization</p></li>
<li><p><a class="reference internal" href="settings.html"><span class="doc">Settings</span></a>: Configuration settings for algorithms</p></li>
<li><p><a class="reference internal" href="factory_pattern.html"><span class="doc">Factory pattern</span></a>: Creating algorithm instances</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hamiltonian_constructor.html" class="btn btn-neutral float-left" title="Hamiltonian construction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mc_calculator.html" class="btn btn-neutral float-right" title="Multi-configuration calculations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Microsoft Corporation. All rights reserved. Licensed under the MIT License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>