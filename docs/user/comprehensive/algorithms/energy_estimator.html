

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Energy estimation &mdash; qdk-chemistry 1.0.0-rc1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=06674eb4" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=81bd8d55"></script>
      <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../../../_static/tabs.js?v=3ee01567"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Hamiltonian construction" href="hamiltonian_constructor.html" />
    <link rel="prev" title="Active space selection" href="active_space.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            qdk-chemistry
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Features, methods and dependencies</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">In-depth user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../design/index.html">High-level design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">Data classes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Algorithm classes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="factory_pattern.html">Factory pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="settings.html">Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="active_space.html">Active space selection</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Energy estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-energyestimator">Using the EnergyEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#available-implementations">Available implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#related-classes">Related classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#further-reading">Further reading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hamiltonian_constructor.html">Hamiltonian construction</a></li>
<li class="toctree-l3"><a class="reference internal" href="localizer.html">Orbital localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_calculator.html">Multi-configuration calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="mcscf.html">Multi-configuration <span class="xref std std-term">SCF</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="qubit_mapper.html">Qubit mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="scf_solver.html">Self-consistent field (SCF) solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="stability_checker.html">Stability analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="state_preparation.html">State preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#quick-reference">Quick reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#discovering-implementations">Discovering implementations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basis_functionals.html">Available functionals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model_hamiltonians.html">Model Hamiltonians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins.html">Plugins</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/cpp_api.html">C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Acronym definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">qdk-chemistry</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">In-depth user guide</a></li>
          <li class="breadcrumb-item"><a href="index.html">Algorithm classes</a></li>
      <li class="breadcrumb-item active">Energy estimation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/user/comprehensive/algorithms/energy_estimator.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="energy-estimation">
<h1>Energy estimation<a class="headerlink" href="#energy-estimation" title="Link to this heading"></a></h1>
<p>The <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.EnergyEstimator" title="qdk_chemistry.algorithms.EnergyEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyEstimator</span></code></a> algorithm in QDK/Chemistry estimates the energy of a quantum state by measuring expectation values of Pauli operators.
Following QDK/Chemistry’s <a class="reference internal" href="../design/index.html"><span class="doc">algorithm design principles</span></a>, it takes an OpenQASM circuit (from <a class="reference internal" href="state_preparation.html"><span class="doc">StatePreparation</span></a>) and a <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.QubitHamiltonian" title="qdk_chemistry.data.QubitHamiltonian"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitHamiltonian</span></code></a> (from <a class="reference internal" href="qubit_mapper.html"><span class="doc">QubitMapper</span></a>) as input and returns energy expectation values with statistical uncertainty.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.EnergyEstimator" title="qdk_chemistry.algorithms.EnergyEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyEstimator</span></code></a> evaluates the expectation value of a <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.QubitHamiltonian" title="qdk_chemistry.data.QubitHamiltonian"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitHamiltonian</span></code></a> with respect to a given quantum circuit that loads a wavefunction onto qubits.
It takes a Circuit object with target qubit Hamiltonians and automatically generates the corresponding measurement circuits.
These circuits are executed on a selected backend simulator with the user-specified number of shots, and the resulting bitstring statistics are used to calculate per-term expectation values and the total energy.</p>
<p>The algorithm supports:</p>
<dl class="simple">
<dt>Multiple simulator backends</dt><dd><p>QDK’s native Q# simulator or Qiskit’s Aer simulator</p>
</dd>
<dt>Noise modeling</dt><dd><p>Depolarizing noise, bit flip noise, Pauli noise, phase flip noise, and qubit loss simulation</p>
</dd>
<dt>Grouped measurements</dt><dd><p>Efficient measurement of commuting Pauli terms in a single circuit execution</p>
</dd>
<dt>Classical coefficient handling</dt><dd><p>Pre-computed classical contributions from Hamiltonian filtering</p>
</dd>
</dl>
<p>A typical workflow connects <a class="reference internal" href="state_preparation.html"><span class="doc">StatePreparation</span></a> (which loads the wavefunction onto qubits) with EnergyEstimator (which measures the energy):</p>
<ol class="arabic simple">
<li><p>Prepare a <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.Wavefunction" title="qdk_chemistry.data.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a> from a multi-configuration calculation</p></li>
<li><p>Generate an OpenQASM circuit using <a class="reference internal" href="state_preparation.html"><span class="doc">StatePreparation</span></a></p></li>
<li><p>Map the Hamiltonian to qubit operators using <a class="reference internal" href="qubit_mapper.html"><span class="doc">QubitMapper</span></a></p></li>
<li><p>Estimate the energy using EnergyEstimator</p></li>
</ol>
</section>
<section id="using-the-energyestimator">
<h2>Using the EnergyEstimator<a class="headerlink" href="#using-the-energyestimator" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This algorithm is currently available only in the Python API.</p>
</div>
<p>This section demonstrates how to create, configure, and run an energy estimation.
The <code class="docutils literal notranslate"><span class="pre">run</span></code> method returns an energy expectation value with variance and the raw measurement data.</p>
<section id="input-requirements">
<h3>Input requirements<a class="headerlink" href="#input-requirements" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.EnergyEstimator" title="qdk_chemistry.algorithms.EnergyEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyEstimator</span></code></a> requires the following inputs:</p>
<dl class="simple">
<dt>OpenQASM circuit</dt><dd><p>A quantum circuit string in OpenQASM format that prepares the target quantum state. This is typically generated by the <a class="reference internal" href="state_preparation.html"><span class="doc">StatePreparation</span></a> algorithm from a <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.Wavefunction" title="qdk_chemistry.data.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a>.</p>
</dd>
<dt>QubitHamiltonian</dt><dd><p>A <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.QubitHamiltonian" title="qdk_chemistry.data.QubitHamiltonian"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitHamiltonian</span></code></a> instance containing the Pauli-string representation of the electronic Hamiltonian. This is obtained from the <a class="reference internal" href="qubit_mapper.html"><span class="doc">QubitMapper</span></a> algorithm.</p>
</dd>
<dt>Number of shots</dt><dd><p>The number of measurement repetitions to perform for statistical sampling.
More shots reduce statistical uncertainty but increase computational cost.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The circuit and Hamiltonian must be compatible—they should use the same qubit encoding and be derived from the same underlying molecular system. The estimator automatically generates measurement circuits for each Pauli term in the Hamiltonian and performs the circuit sampling internally.</p>
</div>
<p class="rubric">Creating an estimator</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio" /><label class="tab-label" for="tab-set--0-input--1">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">create</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">QubitHamiltonian</span>

<span class="c1"># Import noise models for Qiskit Aer simulator examples</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_aer.noise</span><span class="w"> </span><span class="kn">import</span> <span class="n">NoiseModel</span><span class="p">,</span> <span class="n">depolarizing_error</span>

<span class="c1"># Import noise models for QDK simulator examples</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qsharp</span><span class="w"> </span><span class="kn">import</span> <span class="n">DepolarizingNoise</span>

<span class="c1"># Create energy estimator using Qsharp simulator as backend</span>
<span class="n">qdk_estimator</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;energy_estimator&quot;</span><span class="p">,</span> <span class="s2">&quot;qdk_base_simulator&quot;</span><span class="p">)</span>

<span class="c1"># Create energy estimator using Qiskit Aer simulator as backend</span>
<span class="n">qiskit_estimator</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;energy_estimator&quot;</span><span class="p">,</span> <span class="s2">&quot;qiskit_aer_simulator&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p class="rubric">Configuring settings and running</p>
<p>Settings vary by implementation. The QDK backend supports noise models and qubit loss, while the Qiskit backend supports custom Aer noise models.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio" /><label class="tab-label" for="tab-set--1-input--1">Python API (QDK Backend)</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a simple quantum circuit in QASM and a qubit Hamiltonian</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span>
    <span class="n">qasm</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    include &quot;stdgates.inc&quot;;</span>
<span class="s2">    qubit[2] q;</span>
<span class="s2">    rz(pi) q[0];</span>
<span class="s2">    x q[0];</span>
<span class="s2">    cx q[0], q[1];</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="p">)</span>
<span class="n">qubit_hamiltonians</span> <span class="o">=</span> <span class="p">[</span><span class="n">QubitHamiltonian</span><span class="p">([</span><span class="s2">&quot;ZZ&quot;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]))]</span>

<span class="c1"># Run energy estimation using Qsharp simulator without noise</span>
<span class="n">energy_expectation_results</span><span class="p">,</span> <span class="n">measurement_data</span> <span class="o">=</span> <span class="n">qdk_estimator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">circuit</span><span class="p">,</span> <span class="n">qubit_hamiltonians</span><span class="p">,</span> <span class="n">total_shots</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Energy expectation value from noiseless QDK Simulator: &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">energy_expectation_results</span><span class="o">.</span><span class="n">energy_expectation_value</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>

<span class="c1"># Create energy estimator using Qsharp simulator with depolarizing noise</span>
<span class="n">noise_model</span> <span class="o">=</span> <span class="n">DepolarizingNoise</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">qdk_estimator</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;energy_estimator&quot;</span><span class="p">,</span> <span class="s2">&quot;qdk_base_simulator&quot;</span><span class="p">)</span>
<span class="n">energy_expectation_results</span><span class="p">,</span> <span class="n">measurement_data</span> <span class="o">=</span> <span class="n">qdk_estimator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">circuit</span><span class="p">,</span> <span class="n">qubit_hamiltonians</span><span class="p">,</span> <span class="n">total_shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Energy expectation value from QDK Simulator with depolarizing noise: &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">energy_expectation_results</span><span class="o">.</span><span class="n">energy_expectation_value</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>

<span class="c1"># Create energy estimator using Qsharp simulator with qubit loss</span>
<span class="n">qdk_estimator</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;energy_estimator&quot;</span><span class="p">,</span> <span class="s2">&quot;qdk_base_simulator&quot;</span><span class="p">,</span> <span class="n">qubit_loss</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">energy_expectation_results</span><span class="p">,</span> <span class="n">measurement_data</span> <span class="o">=</span> <span class="n">qdk_estimator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">circuit</span><span class="p">,</span> <span class="n">qubit_hamiltonians</span><span class="p">,</span> <span class="n">total_shots</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Energy expectation value from QDK Simulator with qubit loss: &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">energy_expectation_results</span><span class="o">.</span><span class="n">energy_expectation_value</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio" /><label class="tab-label" for="tab-set--1-input--2">Python API (Qiskit Backend)</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run energy estimation using Qiskit Aer simulator without noise</span>
<span class="n">energy_expectation_results</span><span class="p">,</span> <span class="n">measurement_data</span> <span class="o">=</span> <span class="n">qiskit_estimator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">circuit</span><span class="p">,</span> <span class="n">qubit_hamiltonians</span><span class="p">,</span> <span class="n">total_shots</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Energy expectation value from Qiskit Aer Simulator: </span><span class="si">{</span><span class="n">energy_expectation_results</span><span class="o">.</span><span class="n">energy_expectation_value</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>

<span class="c1"># Create energy estimator using Qiskit Aer simulator with noise model</span>
<span class="n">noise_model</span> <span class="o">=</span> <span class="n">NoiseModel</span><span class="p">(</span><span class="n">basis_gates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rz&quot;</span><span class="p">,</span> <span class="s2">&quot;sx&quot;</span><span class="p">,</span> <span class="s2">&quot;cx&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">])</span>
<span class="n">noise_model</span><span class="o">.</span><span class="n">add_all_qubit_quantum_error</span><span class="p">(</span><span class="n">depolarizing_error</span><span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="s2">&quot;rz&quot;</span><span class="p">,</span> <span class="s2">&quot;sx&quot;</span><span class="p">])</span>
<span class="n">noise_model</span><span class="o">.</span><span class="n">add_all_qubit_quantum_error</span><span class="p">(</span><span class="n">depolarizing_error</span><span class="p">(</span><span class="mf">0.007</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="s2">&quot;cx&quot;</span><span class="p">])</span>

<span class="n">qiskit_estimator</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;energy_estimator&quot;</span><span class="p">,</span> <span class="s2">&quot;qiskit_aer_simulator&quot;</span><span class="p">)</span>
<span class="n">energy_expectation_results</span><span class="p">,</span> <span class="n">measurement_data</span> <span class="o">=</span> <span class="n">qiskit_estimator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">circuit</span><span class="p">,</span>
    <span class="n">qubit_hamiltonians</span><span class="p">,</span>
    <span class="n">total_shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Energy expectation value from Qiskit Aer Simulator with noise: &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">energy_expectation_results</span><span class="o">.</span><span class="n">energy_expectation_value</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="available-implementations">
<h2>Available implementations<a class="headerlink" href="#available-implementations" title="Link to this heading"></a></h2>
<p>QDK/Chemistry’s <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.EnergyEstimator" title="qdk_chemistry.algorithms.EnergyEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyEstimator</span></code></a> provides a unified interface for quantum circuit simulation and energy measurement.
You can discover available implementations programmatically:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio" /><label class="tab-label" for="tab-set--2-input--1">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">registry</span>  <span class="c1"># noqa: E402</span>

<span class="nb">print</span><span class="p">(</span><span class="n">registry</span><span class="o">.</span><span class="n">available</span><span class="p">(</span><span class="s2">&quot;energy_estimator&quot;</span><span class="p">))</span>
<span class="c1"># [&#39;qdk_base_simulator&#39;, &#39;qiskit_aer_simulator&#39;]</span>
</pre></div>
</div>
</div>
</div>
<section id="qdk-base-simulator">
<h3>QDK base simulator<a class="headerlink" href="#qdk-base-simulator" title="Link to this heading"></a></h3>
<p class="rubric">Factory name: <code class="docutils literal notranslate"><span class="pre">&quot;qdk_base_simulator&quot;</span></code></p>
<p>Native QDK/Chemistry implementation using the Q# simulator. Supports various noise models for realistic quantum hardware simulation.</p>
<p class="rubric">Constructor parameters</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seed</span></code></p></td>
<td><p>int</p></td>
<td><p>Random seed for reproducibility. Default is 42.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">noise_model</span></code></p></td>
<td><p>NoiseModel | None</p></td>
<td><p>Q# noise model (<code class="docutils literal notranslate"><span class="pre">DepolarizingNoise</span></code>, <code class="docutils literal notranslate"><span class="pre">BitFlipNoise</span></code>, <code class="docutils literal notranslate"><span class="pre">PauliNoise</span></code>, or <code class="docutils literal notranslate"><span class="pre">PhaseFlipNoise</span></code>). Default is None (noiseless).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qubit_loss</span></code></p></td>
<td><p>float</p></td>
<td><p>Probability of qubit loss per operation (0.0 to 1.0). Default is 0.0.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Run parameters</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">circuit_qasm</span></code></p></td>
<td><p>str</p></td>
<td><p>OpenQASM circuit string (from StatePreparation)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qubit_hamiltonians</span></code></p></td>
<td><p>list[QubitHamiltonian]</p></td>
<td><p>List of qubit Hamiltonians to measure</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">total_shots</span></code></p></td>
<td><p>int</p></td>
<td><p>Total number of measurement shots</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">classical_coeffs</span></code></p></td>
<td><p>list | None</p></td>
<td><p>Pre-computed classical coefficients from Hamiltonian filtering. Default is None.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="qiskit-aer-simulator">
<h3>Qiskit Aer Simulator<a class="headerlink" href="#qiskit-aer-simulator" title="Link to this heading"></a></h3>
<p class="rubric">Factory name: <code class="docutils literal notranslate"><span class="pre">&quot;qiskit_aer_simulator&quot;</span></code></p>
<p>Energy estimation using Qiskit’s Aer simulator backend. Provides access to Qiskit’s extensive noise modeling capabilities.</p>
<p class="rubric">Constructor parameters</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">backend</span></code></p></td>
<td><p>BackendV2 | None</p></td>
<td><p>Qiskit Aer backend instance with optional noise model. Default is None (uses default Aer simulator).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">seed</span></code></p></td>
<td><p>int</p></td>
<td><p>Random seed for reproducibility. Default is 42.</p></td>
</tr>
</tbody>
</table>
<p>For more details on how QDK/Chemistry interfaces with external packages, see the <a class="reference internal" href="../plugins.html#plugin-system"><span class="std std-ref">plugin system</span></a> documentation.</p>
</section>
</section>
<section id="related-classes">
<h2>Related classes<a class="headerlink" href="#related-classes" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.QubitHamiltonian" title="qdk_chemistry.data.QubitHamiltonian"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitHamiltonian</span></code></a>: Input qubit Hamiltonian from QubitMapper</p></li>
<li><p><a class="reference internal" href="../data/wavefunction.html"><span class="doc">Wavefunction</span></a>: Source wavefunction for state preparation</p></li>
</ul>
</section>
<section id="further-reading">
<h2>Further reading<a class="headerlink" href="#further-reading" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>The above examples can be downloaded as a complete <a class="reference external" href="../../../_static/examples/python/energy_estimator.py">Python</a> script.</p></li>
<li><p><a class="reference internal" href="state_preparation.html"><span class="doc">StatePreparation</span></a>: Load wavefunctions onto qubits as quantum circuits</p></li>
<li><p><a class="reference internal" href="qubit_mapper.html"><span class="doc">QubitMapper</span></a>: Map fermionic Hamiltonians to qubit operators</p></li>
<li><p>See the <code class="docutils literal notranslate"><span class="pre">examples/state_prep_energy.ipynb</span></code> notebook for an end-to-end workflow demonstration</p></li>
<li><p><a class="reference internal" href="settings.html"><span class="doc">Settings</span></a>: Configuration settings for algorithms</p></li>
<li><p><a class="reference internal" href="factory_pattern.html"><span class="doc">Factory Pattern</span></a>: Understanding algorithm creation</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="active_space.html" class="btn btn-neutral float-left" title="Active space selection" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hamiltonian_constructor.html" class="btn btn-neutral float-right" title="Hamiltonian construction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Microsoft Corporation. All rights reserved. Licensed under the MIT License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>