

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Active space selection &mdash; qdk-chemistry 1.0.0-rc1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=06674eb4" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=81bd8d55"></script>
      <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../../../_static/tabs.js?v=3ee01567"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Energy estimation" href="energy_estimator.html" />
    <link rel="prev" title="Settings" href="settings.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            qdk-chemistry
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Features, methods and dependencies</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">In-depth user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../design/index.html">High-level design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">Data classes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Algorithm classes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="factory_pattern.html">Factory pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="settings.html">Settings</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Active space selection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-an-active-space-selection">Running an active space selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#available-implementations">Available implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#related-classes">Related classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#further-reading">Further reading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="energy_estimator.html">Energy estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="hamiltonian_constructor.html">Hamiltonian construction</a></li>
<li class="toctree-l3"><a class="reference internal" href="localizer.html">Orbital localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_calculator.html">Multi-configuration calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="mcscf.html">Multi-configuration <span class="xref std std-term">SCF</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="qubit_mapper.html">Qubit mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="scf_solver.html">Self-consistent field (SCF) solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="stability_checker.html">Stability analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="state_preparation.html">State preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#quick-reference">Quick reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#discovering-implementations">Discovering implementations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basis_functionals.html">Available functionals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model_hamiltonians.html">Model Hamiltonians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins.html">Plugins</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/cpp_api.html">C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Acronym definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">qdk-chemistry</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">In-depth user guide</a></li>
          <li class="breadcrumb-item"><a href="index.html">Algorithm classes</a></li>
      <li class="breadcrumb-item active">Active space selection</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/user/comprehensive/algorithms/active_space.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="active-space-selection">
<h1>Active space selection<a class="headerlink" href="#active-space-selection" title="Link to this heading"></a></h1>
<p>The <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.ActiveSpaceSelector" title="qdk_chemistry.algorithms.ActiveSpaceSelector"><code class="xref py py-class docutils literal notranslate"><span class="pre">ActiveSpaceSelector</span></code></a> algorithm in QDK/Chemistry performs active space selection to identify the most chemically relevant orbitals for <a class="reference internal" href="mc_calculator.html"><span class="doc">multi-configurational calculations</span></a>.
Following QDK/Chemistry’s <a class="reference internal" href="../design/index.html"><span class="doc">algorithm design principles</span></a>, it takes a <a class="reference internal" href="../data/wavefunction.html"><span class="doc">Wavefunction</span></a> instance as input and produces a <a class="reference internal" href="../data/wavefunction.html"><span class="doc">Wavefunction</span></a> instance with active space information as output.
Its primary purpose is to reduce the cost of quantum chemistry calculations by focusing on a specific set of relevant (active) orbitals while treating others as either fully occupied (core) or empty (virtual).</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Active space methods classify molecular orbitals into three categories:</p>
<dl class="simple">
<dt>Inactive (core) orbitals</dt><dd><p>Always doubly occupied and not explicitly correlated</p>
</dd>
<dt>Active orbitals</dt><dd><p>Allow variable occupation and are explicitly correlated</p>
</dd>
<dt>Virtual orbitals</dt><dd><p>Always empty and not explicitly correlated</p>
</dd>
</dl>
<p>The key challenge is selecting which orbitals to include in the active space.
An ideal active space should:</p>
<ul class="simple">
<li><p>Include all orbitals with significant entanglement character</p></li>
<li><p>Be as compact as possible to keep computational cost manageable</p></li>
<li><p>Capture the essential chemistry of the system</p></li>
</ul>
<p>The selected active space then serves as input for post-<a class="reference internal" href="../../../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> methods like <a class="reference internal" href="mc_calculator.html"><span class="doc">multi-configuration calculations</span></a> that explicitly treat electron correlation within the active space.</p>
</section>
<section id="running-an-active-space-selection">
<h2>Running an active space selection<a class="headerlink" href="#running-an-active-space-selection" title="Link to this heading"></a></h2>
<p>This section demonstrates how to create, configure, and run an active space selection.
The <code class="docutils literal notranslate"><span class="pre">run</span></code> method takes a <a class="reference internal" href="../data/wavefunction.html"><span class="doc">Wavefunction</span></a> from a prior <a class="reference internal" href="../../../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> calculation and returns a new <a class="reference internal" href="../data/wavefunction.html"><span class="doc">Wavefunction</span></a> with active space information populated.</p>
<section id="input-requirements">
<h3>Input requirements<a class="headerlink" href="#input-requirements" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.ActiveSpaceSelector" title="qdk_chemistry.algorithms.ActiveSpaceSelector"><code class="xref py py-class docutils literal notranslate"><span class="pre">ActiveSpaceSelector</span></code></a> requires the following input:</p>
<dl class="simple">
<dt>Wavefunction</dt><dd><p>A <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.data.html#qdk_chemistry.data.Wavefunction" title="qdk_chemistry.data.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a> instance containing data necessary for active space selection, including: orbital information, electron counts, etc.
Some selection methods (e.g., entropy-based) may require additional information such as orbital occupation numbers or entropies from a prior multi-configuration calculation.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The specific requirements depend on the chosen implementation. Manual selection methods (like <code class="docutils literal notranslate"><span class="pre">qdk_valence</span></code>) require user-specified active space sizes, while automatic methods (like <code class="docutils literal notranslate"><span class="pre">qdk_occupation</span></code> or <code class="docutils literal notranslate"><span class="pre">qdk_entropy</span></code>) analyze orbital properties to determine the active space.</p>
</div>
<p class="rubric">Creating an active space selector</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio" /><label class="tab-label" for="tab-set--0-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;qdk/chemistry.hpp&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">qdk</span><span class="o">::</span><span class="nn">chemistry</span><span class="o">::</span><span class="nn">algorithms</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">qdk</span><span class="o">::</span><span class="nn">chemistry</span><span class="o">::</span><span class="nn">data</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Create the default ActiveSpaceSelector instance</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_space_selector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActiveSpaceSelectorFactory</span><span class="o">::</span><span class="n">create</span><span class="p">();</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio" /><label class="tab-label" for="tab-set--0-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">create</span>

<span class="c1"># Create the default ActiveSpaceSelector instance</span>
<span class="n">active_space_selector</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;active_space_selector&quot;</span><span class="p">,</span> <span class="s2">&quot;qdk_valence&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p class="rubric">Configuring settings</p>
<p>Settings can be modified using the <code class="docutils literal notranslate"><span class="pre">settings()</span></code> object.
See <a class="reference internal" href="#available-implementations">Available implementations</a> below for implementation-specific options.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio" /><label class="tab-label" for="tab-set--1-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Configure the selector using the settings interface</span>
<span class="w">  </span><span class="c1">// Set the number of electrons and orbitals for the active space</span>
<span class="w">  </span><span class="n">active_space_selector</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;num_active_electrons&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">  </span><span class="n">active_space_selector</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;num_active_orbitals&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio" /><label class="tab-label" for="tab-set--1-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure the selector using the settings interface</span>
<span class="c1"># Set the number of electrons and orbitals for the active space</span>
<span class="n">active_space_selector</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;num_active_electrons&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">active_space_selector</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;num_active_orbitals&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<p class="rubric">Running the selection</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio" /><label class="tab-label" for="tab-set--2-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Load a molecular structure (water molecule) from XYZ file</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">structure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Structure</span><span class="o">::</span><span class="n">from_xyz_file</span><span class="p">(</span><span class="s">&quot;../data/water.structure.xyz&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">charge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// First, run SCF to get molecular orbitals</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">scf_solver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ScfSolverFactory</span><span class="o">::</span><span class="n">create</span><span class="p">();</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">scf_energy</span><span class="p">,</span><span class="w"> </span><span class="n">scf_wavefunction</span><span class="p">]</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">scf_solver</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span><span class="w"> </span><span class="n">charge</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;6-31g&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Run active space selection</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_wavefunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">active_space_selector</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">scf_wavefunction</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_orbitals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">active_wavefunction</span><span class="o">-&gt;</span><span class="n">get_orbitals</span><span class="p">();</span>

<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;SCF Energy: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">scf_energy</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; Hartree&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Active orbitals summary:</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">active_orbitals</span><span class="o">-&gt;</span><span class="n">get_summary</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio" /><label class="tab-label" for="tab-set--2-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>  <span class="c1"># noqa: E402</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Structure</span>  <span class="c1"># noqa: E402</span>

<span class="c1"># Load a molecular structure (water molecule) from XYZ file</span>
<span class="n">structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="o">.</span><span class="n">from_xyz_file</span><span class="p">(</span>
    <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;../data/water.structure.xyz&quot;</span>
<span class="p">)</span>
<span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># First, run SCF to get molecular orbitals</span>
<span class="n">scf_solver</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;scf_solver&quot;</span><span class="p">)</span>
<span class="n">scf_energy</span><span class="p">,</span> <span class="n">scf_wavefunction</span> <span class="o">=</span> <span class="n">scf_solver</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">structure</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="n">charge</span><span class="p">,</span> <span class="n">spin_multiplicity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">basis_or_guess</span><span class="o">=</span><span class="s2">&quot;6-31g&quot;</span>
<span class="p">)</span>

<span class="c1"># Run active space selection</span>
<span class="n">active_wavefunction</span> <span class="o">=</span> <span class="n">active_space_selector</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">scf_wavefunction</span><span class="p">)</span>
<span class="n">active_orbitals</span> <span class="o">=</span> <span class="n">active_wavefunction</span><span class="o">.</span><span class="n">get_orbitals</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SCF Energy: </span><span class="si">{</span><span class="n">scf_energy</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2"> Hartree&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Active orbitals summary:</span><span class="se">\n</span><span class="si">{</span><span class="n">active_orbitals</span><span class="o">.</span><span class="n">get_summary</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="available-implementations">
<h2>Available implementations<a class="headerlink" href="#available-implementations" title="Link to this heading"></a></h2>
<p>QDK/Chemistry’s <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.algorithms.html#qdk_chemistry.algorithms.ActiveSpaceSelector" title="qdk_chemistry.algorithms.ActiveSpaceSelector"><code class="xref py py-class docutils literal notranslate"><span class="pre">ActiveSpaceSelector</span></code></a> provides implementations for various selection strategies.
You can discover available implementations programmatically:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio" /><label class="tab-label" for="tab-set--3-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActiveSpaceSelectorFactory</span><span class="o">::</span><span class="n">available</span><span class="p">();</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">names</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio" /><label class="tab-label" for="tab-set--3-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">registry</span>  <span class="c1"># noqa: E402</span>

<span class="nb">print</span><span class="p">(</span><span class="n">registry</span><span class="o">.</span><span class="n">available</span><span class="p">(</span><span class="s2">&quot;active_space_selector&quot;</span><span class="p">))</span>
<span class="c1"># [&#39;pyscf_avas&#39;, &#39;qdk_occupation&#39;, &#39;qdk_autocas_eos&#39;, &#39;qdk_autocas&#39;, &#39;qdk_valence&#39;]</span>
</pre></div>
</div>
</div>
</div>
<section id="qdk-valence">
<h3>QDK Valence<a class="headerlink" href="#qdk-valence" title="Link to this heading"></a></h3>
<p class="rubric">Factory name: <code class="docutils literal notranslate"><span class="pre">&quot;qdk_valence&quot;</span></code> (default)</p>
<p>Manual valence-based selection where users specify the number of active electrons and orbitals.
Selects orbitals near the <a class="reference internal" href="../../../glossary.html#term-HOMO"><span class="xref std std-term">HOMO</span></a>-<a class="reference internal" href="../../../glossary.html#term-LUMO"><span class="xref std std-term">LUMO</span></a> gap.</p>
<p class="rubric">Settings</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 15.0%" />
<col style="width: 15.0%" />
<col style="width: 45.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">num_active_electrons</span></code></p></td>
<td><p>int</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-1</span></code></p></td>
<td><p>Number of electrons in the active space (required)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">num_active_orbitals</span></code></p></td>
<td><p>int</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-1</span></code></p></td>
<td><p>Number of orbitals in the active space (required)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="qdk-occupation">
<h3>QDK Occupation<a class="headerlink" href="#qdk-occupation" title="Link to this heading"></a></h3>
<p class="rubric">Factory name: <code class="docutils literal notranslate"><span class="pre">&quot;qdk_occupation&quot;</span></code></p>
<p>Automatic selection based on orbital occupation numbers, identifying orbitals with fractional occupation.</p>
<p class="rubric">Settings</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 15.0%" />
<col style="width: 15.0%" />
<col style="width: 45.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">occupation_threshold</span></code></p></td>
<td><p>float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></td>
<td><p>Orbitals with occupations deviating from 0 or 2 by more than this threshold are selected</p></td>
</tr>
</tbody>
</table>
</section>
<section id="qdk-autocas">
<span id="autocas-algorithm"></span><h3>QDK AutoCAS<a class="headerlink" href="#qdk-autocas" title="Link to this heading"></a></h3>
<p class="rubric">Factory name: <code class="docutils literal notranslate"><span class="pre">&quot;qdk_autocas&quot;</span></code></p>
<p>Entropy-based automatic selection using histogram-based plateau detection to identify strongly correlated orbitals.
See <a class="reference internal" href="#autocas-algorithm-details"><span class="std std-ref">AutoCAS Algorithm</span></a> below for a detailed description.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method requires the input wavefunction to have orbital entropies populated.
Orbital entropies are computed from the one- and two-electron reduced density matrices (1-<a class="reference internal" href="../../../glossary.html#term-RDM"><span class="xref std std-term">RDM</span></a> and 2-<a class="reference internal" href="../../../glossary.html#term-RDM"><span class="xref std std-term">RDM</span></a>), which are typically obtained from a multi-configuration calculation with <code class="docutils literal notranslate"><span class="pre">calculate_one_rdm=True</span></code> and <code class="docutils literal notranslate"><span class="pre">calculate_two_rdm=True</span></code>.</p>
<p>See <a class="reference internal" href="mc_calculator.html"><span class="doc">MultiConfigurationCalculator</span></a> for details on generating wavefunctions with RDMs.</p>
</div>
<p class="rubric">Settings</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 15.0%" />
<col style="width: 15.0%" />
<col style="width: 45.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">entropy_threshold</span></code></p></td>
<td><p>float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.14</span></code></p></td>
<td><p>Entropy threshold for selection</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">min_plateau_size</span></code></p></td>
<td><p>int</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
<td><p>Minimum size of entropy plateau for selection</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">num_bins</span></code></p></td>
<td><p>int</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code></p></td>
<td><p>Number of histogram bins for plateau detection</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">normalize_entropies</span></code></p></td>
<td><p>bool</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Whether to normalize entropy values</p></td>
</tr>
</tbody>
</table>
</section>
<section id="qdk-autocas-eos">
<h3>QDK AutoCAS EOS<a class="headerlink" href="#qdk-autocas-eos" title="Link to this heading"></a></h3>
<p class="rubric">Factory name: <code class="docutils literal notranslate"><span class="pre">&quot;qdk_autocas_eos&quot;</span></code></p>
<p>Entropy-based selection using consecutive entropy differences to identify plateau boundaries.
See <a class="reference internal" href="#autocas-algorithm-details"><span class="std std-ref">AutoCAS Algorithm</span></a> below for a detailed description.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method requires the input wavefunction to have orbital entropies populated.
Orbital entropies are computed from the one- and two-electron reduced density matrices (1-<a class="reference internal" href="../../../glossary.html#term-RDM"><span class="xref std std-term">RDM</span></a> and 2-<a class="reference internal" href="../../../glossary.html#term-RDM"><span class="xref std std-term">RDM</span></a>), which are typically obtained from a multi-configuration calculation with <code class="docutils literal notranslate"><span class="pre">calculate_one_rdm=True</span></code> and <code class="docutils literal notranslate"><span class="pre">calculate_two_rdm=True</span></code>. See <a class="reference internal" href="mc_calculator.html"><span class="doc">MultiConfigurationCalculator</span></a> for details on generating wavefunctions with RDMs.</p>
</div>
<p class="rubric">Settings</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 15.0%" />
<col style="width: 15.0%" />
<col style="width: 45.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">entropy_threshold</span></code></p></td>
<td><p>float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.14</span></code></p></td>
<td><p>Entropy threshold for selection</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">diff_threshold</span></code></p></td>
<td><p>float</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></td>
<td><p>Difference threshold for EOS-based selection</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">normalize_entropies</span></code></p></td>
<td><p>bool</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Whether to normalize entropy values by the maximum</p></td>
</tr>
</tbody>
</table>
<section id="autocas-algorithm-details">
<span id="id1"></span><h4>AutoCAS Algorithm<a class="headerlink" href="#autocas-algorithm-details" title="Link to this heading"></a></h4>
<p>Selecting an appropriate active space is one of the most challenging aspects of multi-configuration calculations.
Traditional approaches rely on chemical intuition and trial-and-error, which can be unreliable for complex systems.
The AutoCAS algorithm <span id="id2">[<a class="reference internal" href="../../../references.html#id25" title="Christopher J. Stein and Markus Reiher. Automated selection of active orbital spaces. Journal of Chemical Theory and Computation, 12(4):1760-1771, 2016. URL: https://arxiv.org/abs/1602.03835, doi:10.1021/acs.jctc.6b00156.">SR16</a>, <a class="reference internal" href="../../../references.html#id26" title="Christopher J. Stein and Markus Reiher. autoCAS: a program for fully automated multiconfigurational calculations. Journal of Computational Chemistry, 40(25):2216-2226, 2019. URL: https://arxiv.org/abs/1904.00097, doi:10.1002/jcc.25869.">SR19</a>]</span> provides a systematic, black-box approach to active space selection.</p>
<p>AutoCAS leverages concepts from quantum information theory to quantify orbital correlation.
The key insight is that strongly correlated orbitals are highly <em>entangled</em> with the rest of the electronic system.
This entanglement can be measured using the single-orbital entropy <span class="math notranslate nohighlight">\(s_i^{(1)}\)</span>, which quantifies how much information about orbital <span class="math notranslate nohighlight">\(i\)</span> is “shared” with all other orbitals.</p>
<p>Single orbital entropies can be calculated for many-body systems given access to (approximate) one- and two-particle reduced density matrices (<a class="reference internal" href="../../../glossary.html#term-RDM"><span class="xref std std-term">RDM</span></a>) <span id="id3">[<a class="reference internal" href="../../../references.html#id4" title="Katharina Boguslawski and Paweł Tecmer. Orbital entanglement in quantum chemistry. International Journal of Quantum Chemistry, 115(19):1289-1295, 2015. doi:10.1002/qua.24832.">BT15</a>]</span>, which are easily accessible in QDK/Chemistry through multi-configuration wavefunction data structures. As such, single orbital entropies are computed by default when RDMs are requested in <a class="reference internal" href="mc_calculator.html"><span class="doc">multi-configuration calculations</span></a>. The QDK/Chemistry implementation of AutoCAS is agnostic to the underlying wavefunction method, as long as the required RDMs are available, thus allowing for comparisons across different multi-configuration approaches.</p>
<p class="rubric">QDK/Chemistry AutoCAS Variants</p>
<p>QDK/Chemistry provides two entropy-based selection methods:</p>
<dl class="simple">
<dt>AutoCAS (Histogram-Based Plateau Detection)</dt><dd><p>As described in the original AutoCAS protocol <span id="id4">[<a class="reference internal" href="../../../references.html#id25" title="Christopher J. Stein and Markus Reiher. Automated selection of active orbital spaces. Journal of Chemical Theory and Computation, 12(4):1760-1771, 2016. URL: https://arxiv.org/abs/1602.03835, doi:10.1021/acs.jctc.6b00156.">SR16</a>, <a class="reference internal" href="../../../references.html#id26" title="Christopher J. Stein and Markus Reiher. autoCAS: a program for fully automated multiconfigurational calculations. Journal of Computational Chemistry, 40(25):2216-2226, 2019. URL: https://arxiv.org/abs/1904.00097, doi:10.1002/jcc.25869.">SR19</a>]</span>, this method discretizes the entropy distribution into histogram bins and identifies plateaus—contiguous regions where the count of orbitals above each entropy threshold remains constant.
This approach is robust for systems with clear entropy gaps but requires tuning of <code class="docutils literal notranslate"><span class="pre">num_bins</span></code> and <code class="docutils literal notranslate"><span class="pre">min_plateau_size</span></code> parameters.
If none of the entropies exceed the <code class="docutils literal notranslate"><span class="pre">entropy_threshold</span></code>, the system is considered single configurational and all orbitals are excluded from the active space.</p>
</dd>
<dt>AutoCAS-EOS (Entropy Difference Detection)</dt><dd><p>Uses a direct approach that examines consecutive differences in the sorted entropy values. When the difference between adjacent entropies exceeds <code class="docutils literal notranslate"><span class="pre">diff_threshold</span></code> and the entropy is above <code class="docutils literal notranslate"><span class="pre">entropy_threshold</span></code>, a plateau boundary is identified.</p>
</dd>
</dl>
<p>Both methods sort orbitals by decreasing entropy and select the largest identified group of strongly correlated orbitals for the active space.</p>
<p class="rubric">Populating Orbital Entropies</p>
<p>The entropy-based AutoCAS methods require orbital entropies as input, which are computed from the one- and two-electron reduced density matrices (RDMs).
These RDMs must be obtained from a <a class="reference internal" href="mc_calculator.html"><span class="doc">multi-configuration calculation</span></a> that captures static correlation.
A key practical consideration is balancing the cost of this initial calculation against the quality of the resulting entropies.</p>
<p>A recommended approach is to use <a class="reference internal" href="mc_calculator.html#macis-asci"><span class="std std-ref">Selected Configuration Interaction (SCI)</span></a> with a relatively small number of determinants (e.g., 10,000–50,000) within a conservatively chosen active space.
<a class="reference internal" href="../../../glossary.html#term-SCI"><span class="xref std std-term">SCI</span></a> methods are well-suited for this purpose because they:</p>
<ul class="simple">
<li><p>Automatically identify the most important determinants for capturing static correlation</p></li>
<li><p>Scale favorably compared to full configuration interaction</p></li>
<li><p>Provide high-quality RDMs even with truncated determinant spaces</p></li>
</ul>
<p>This approach has been shown to provide a reasonable trade-off between computational cost and entropy accuracy for active space selection.
The resulting entropies are typically sufficient to identify strongly correlated orbitals, even when the <a class="reference internal" href="../../../glossary.html#term-SCI"><span class="xref std std-term">SCI</span></a> calculation uses a fraction of the determinants that would be required for quantitative energy accuracy.</p>
<p class="rubric">Example</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of valence orbitals and electrons can be automatically determined using the utility function <a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.utils.html#qdk_chemistry.utils.compute_valence_space_parameters" title="qdk_chemistry.utils.compute_valence_space_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_valence_space_parameters()</span></code></a>.</p>
</div>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio" /><label class="tab-label" for="tab-set--4-input--1">C++ API</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Create a valence space active space selector</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">valence_selector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActiveSpaceSelectorFactory</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;qdk_valence&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// Automatically select valence parameters based on the input structure</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">num_electrons</span><span class="p">,</span><span class="w"> </span><span class="n">num_orbitals</span><span class="p">]</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">qdk</span><span class="o">::</span><span class="n">chemistry</span><span class="o">::</span><span class="n">utils</span><span class="o">::</span><span class="n">compute_valence_space_parameters</span><span class="p">(</span><span class="n">scf_wavefunction</span><span class="p">,</span>
<span class="w">                                                              </span><span class="n">charge</span><span class="p">);</span>
<span class="w">  </span><span class="n">valence_selector</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;num_active_electrons&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">num_electrons</span><span class="p">);</span>
<span class="w">  </span><span class="n">valence_selector</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;num_active_orbitals&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">num_orbitals</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_valence_wfn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valence_selector</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">scf_wavefunction</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Create active Hamiltonian</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_hamiltonian_generator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HamiltonianConstructorFactory</span><span class="o">::</span><span class="n">create</span><span class="p">();</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_hamiltonian</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">active_hamiltonian_generator</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">active_valence_wfn</span><span class="o">-&gt;</span><span class="n">get_orbitals</span><span class="p">());</span>

<span class="w">  </span><span class="c1">// Run Active Space Calculation with Selected CI</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">mc_calculator</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">MultiConfigurationCalculatorFactory</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;macis_asci&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">mc_calculator</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;ntdets_max&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">50000</span><span class="p">);</span>
<span class="w">  </span><span class="n">mc_calculator</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;calculate_one_rdm&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="w">  </span><span class="n">mc_calculator</span><span class="o">-&gt;</span><span class="n">settings</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;calculate_two_rdm&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">mc_energy</span><span class="p">,</span><span class="w"> </span><span class="n">mc_wavefunction</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mc_calculator</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span>
<span class="w">      </span><span class="n">active_hamiltonian</span><span class="p">,</span><span class="w"> </span><span class="n">num_electrons</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">num_electrons</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Select active space using AutoCAS</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">autocas_selector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActiveSpaceSelectorFactory</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;qdk_autocas_eos&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">active_autocas_wfn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">autocas_selector</span><span class="o">-&gt;</span><span class="n">run</span><span class="p">(</span><span class="n">mc_wavefunction</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;AutoCAS selected active orbitals summary:</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">active_autocas_wfn</span><span class="o">-&gt;</span><span class="n">get_orbitals</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">get_summary</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio" /><label class="tab-label" for="tab-set--4-input--2">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qdk_chemistry.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_valence_space_parameters</span>  <span class="c1"># noqa: E402</span>

<span class="c1"># Create a valence space active space selector</span>
<span class="n">valence_selector</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;active_space_selector&quot;</span><span class="p">,</span> <span class="s2">&quot;qdk_valence&quot;</span><span class="p">)</span>
<span class="c1"># Automatically select valence parameters based on the input structure</span>
<span class="n">num_electrons</span><span class="p">,</span> <span class="n">num_orbitals</span> <span class="o">=</span> <span class="n">compute_valence_space_parameters</span><span class="p">(</span><span class="n">scf_wavefunction</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<span class="n">valence_selector</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;num_active_electrons&quot;</span><span class="p">,</span> <span class="n">num_electrons</span><span class="p">)</span>
<span class="n">valence_selector</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;num_active_orbitals&quot;</span><span class="p">,</span> <span class="n">num_orbitals</span><span class="p">)</span>
<span class="n">active_valence_wfn</span> <span class="o">=</span> <span class="n">valence_selector</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">scf_wavefunction</span><span class="p">)</span>

<span class="c1"># Create active Hamiltonian</span>
<span class="n">active_hamiltonian_generator</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;hamiltonian_constructor&quot;</span><span class="p">)</span>
<span class="n">active_hamiltonian</span> <span class="o">=</span> <span class="n">active_hamiltonian_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">active_valence_wfn</span><span class="o">.</span><span class="n">get_orbitals</span><span class="p">())</span>

<span class="c1"># Run Active Space Calculation with Selected CI</span>
<span class="n">mc_calculator</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;multi_configuration_calculator&quot;</span><span class="p">,</span> <span class="s2">&quot;macis_asci&quot;</span><span class="p">)</span>
<span class="n">mc_calculator</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;ntdets_max&quot;</span><span class="p">,</span> <span class="mi">50000</span><span class="p">)</span>
<span class="n">mc_calculator</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;calculate_one_rdm&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">mc_calculator</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;calculate_two_rdm&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">mc_energy</span><span class="p">,</span> <span class="n">mc_wavefunction</span> <span class="o">=</span> <span class="n">mc_calculator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">active_hamiltonian</span><span class="p">,</span> <span class="n">num_electrons</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_electrons</span> <span class="o">//</span> <span class="mi">2</span>
<span class="p">)</span>

<span class="c1"># Select active space using AutoCAS</span>
<span class="n">autocas_selector</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;active_space_selector&quot;</span><span class="p">,</span> <span class="s2">&quot;qdk_autocas_eos&quot;</span><span class="p">)</span>
<span class="n">active_autocas_wfn</span> <span class="o">=</span> <span class="n">autocas_selector</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mc_wavefunction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AutoCAS selected active orbitals summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">active_autocas_wfn</span><span class="o">.</span><span class="n">get_orbitals</span><span class="p">()</span><span class="o">.</span><span class="n">get_summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="pyscf-avas">
<span id="pyscf-avas-plugin"></span><h3>PySCF AVAS<a class="headerlink" href="#pyscf-avas" title="Link to this heading"></a></h3>
<p class="rubric">Factory name: <code class="docutils literal notranslate"><span class="pre">&quot;pyscf_avas&quot;</span></code></p>
<p>The PySCF plugin provides access to the Automated Valence Active Space (<a class="reference internal" href="../../../glossary.html#term-AVAS"><span class="xref std std-term">AVAS</span></a>) method from <a class="reference external" href="https://pyscf.org/">PySCF</a>.
<a class="reference internal" href="../../../glossary.html#term-AVAS"><span class="xref std std-term">AVAS</span></a> selects active orbitals by projecting molecular orbitals onto a target atomic orbital basis.
See the original <a class="reference internal" href="../../../glossary.html#term-AVAS"><span class="xref std std-term">AVAS</span></a> publication <span id="id5">[<a class="reference internal" href="../../../references.html#id2" title="Elvira R. Sayfutyarova, Qiming Sun, Garnet Kin-Lic Chan, and Gerald Knizia. Automated construction of molecular active spaces from atomic valence orbitals. Journal of Chemical Theory and Computation, 13(9):4063-4078, 2017. URL: https://arxiv.org/abs/1701.07862, doi:10.1021/acs.jctc.7b00128.">SSCK17</a>]</span> for details.</p>
<p class="rubric">Settings</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 15.0%" />
<col style="width: 15.0%" />
<col style="width: 45.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ao_labels</span></code></p></td>
<td><p>list[str]</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[]</span></code></p></td>
<td><p>Atomic orbital labels to include (e.g., <code class="docutils literal notranslate"><span class="pre">[&quot;Fe</span> <span class="pre">3d&quot;,</span> <span class="pre">&quot;Fe</span> <span class="pre">4d&quot;]</span></code>); required</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">canonicalize</span></code></p></td>
<td><p>bool</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
<td><p>Whether to canonicalize active orbitals after selection</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">openshell_option</span></code></p></td>
<td><p>int</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>Handling of singly-occupied orbitals: <code class="docutils literal notranslate"><span class="pre">2</span></code> = project as alpha, <code class="docutils literal notranslate"><span class="pre">3</span></code> = keep in active space</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio" /><label class="tab-label" for="tab-set--5-input--1">Python API</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">avas</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="s2">&quot;active_space_selector&quot;</span><span class="p">,</span> <span class="s2">&quot;pyscf_avas&quot;</span><span class="p">)</span>
<span class="n">avas</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;ao_labels&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;O 2p&quot;</span><span class="p">,</span> <span class="s2">&quot;O 2s&quot;</span><span class="p">])</span>
<span class="n">avas</span><span class="o">.</span><span class="n">settings</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;canonicalize&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">active_wavefunction</span> <span class="o">=</span> <span class="n">avas</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">scf_wavefunction</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="related-classes">
<h2>Related classes<a class="headerlink" href="#related-classes" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../data/wavefunction.html"><span class="doc">Wavefunction</span></a>: Input wavefunction from <a class="reference internal" href="../../../glossary.html#term-SCF"><span class="xref std std-term">SCF</span></a> calculation</p></li>
<li><p><a class="reference internal" href="../data/orbitals.html"><span class="doc">Orbitals</span></a>: Contains orbital information and active space indices</p></li>
</ul>
</section>
<section id="further-reading">
<h2>Further reading<a class="headerlink" href="#further-reading" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>The above examples can be downloaded as a complete <a class="reference external" href="../../../_static/examples/python/active_space_selector.py">Python</a> script or <a class="reference external" href="../../../_static/examples/cpp/active_space_selector.cpp">C++</a> source file.</p></li>
<li><p><a class="reference internal" href="mc_calculator.html"><span class="doc">MCCalculator</span></a>: Uses active space for multiconfigurational calculations</p></li>
<li><p><a class="reference internal" href="settings.html"><span class="doc">Settings</span></a>: Configuration settings for algorithms</p></li>
<li><p><a class="reference internal" href="factory_pattern.html"><span class="doc">Factory Pattern</span></a>: Understanding algorithm creation</p></li>
<li><p><a class="reference internal" href="../../../api/api_autogen/qdk_chemistry.utils.html#qdk_chemistry.utils.compute_valence_space_parameters" title="qdk_chemistry.utils.compute_valence_space_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_valence_space_parameters()</span></code></a>: Utility function to determine valence orbitals and electrons</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="settings.html" class="btn btn-neutral float-left" title="Settings" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="energy_estimator.html" class="btn btn-neutral float-right" title="Energy estimation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Microsoft Corporation. All rights reserved. Licensed under the MIT License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>