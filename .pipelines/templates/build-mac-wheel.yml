parameters:
- name: march
  type: string
  default: armv8-a
- name: buildType
  type: string
  default: Debug
- name: buildTesting
  type: string
  default: OFF
- name: enableCoverage
  type: string
  default: OFF
- name: agentBuildDirectory
  type: string
  default: $(Agent.BuildDirectory)
- name: pythonVersion
  type: string
  default: 3.11
- name: cmakeVersion
  type: string
  default: 3.28.3
- name: hdf5Version
  type: string
  default: 1.13.0
- name: blisVersion
  type: string
  default: 2.0
- name: libflameVersion
  type: string
  default: 5.2.0
- name: pyenvVersion
  type: string
  default: 2.6.15
- name: macBuild
  type: string
  default: ON
steps:
- checkout: self
  persistCredentials: true
  path: qdk-chemistry

- task: PipAuthenticate@1
  displayName: Pip Authenticate
  inputs:
    artifactFeeds: ""

- script: |
    echo "Running pip wheel build..."
    bash .pipelines/pip-scripts/build-pip-wheels.sh ${{ parameters.march }} \
                                                    ${{ parameters.pythonVersion }} \
                                                    ${{ parameters.buildType }} \
                                                    ${{ parameters.buildTesting }} \
                                                    ${{ parameters.enableCoverage }} \
                                                    ${{ parameters.cmakeVersion }} \
                                                    ${{ parameters.hdf5Version }} \
                                                    ${{ parameters.blisVersion }} \
                                                    ${{ parameters.libflameVersion }} \
                                                    ${{ parameters.pyenvVersion }} \
                                                    ${{ parameters.macBuild }}
  displayName: Build macOS wheel
